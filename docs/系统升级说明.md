# MAG System ç³»ç»Ÿå‡çº§è¯´æ˜

## ğŸ“… æ›´æ–°æ—¥æœŸ
2026-01-24

## ğŸ¯ å‡çº§ç›®æ ‡
å°†MAGç³»ç»Ÿä»"å•ä½“åº”ç”¨åˆ°Lambdaå‡½æ•°æ˜ å°„å·¥å…·"å‡çº§ä¸º**å®Œæ•´serverlessåº”ç”¨è¿ç§»ç³»ç»Ÿ**ï¼Œèƒ½å¤Ÿç”Ÿæˆå¯ç›´æ¥éƒ¨ç½²åˆ°AWSçš„å®Œæ•´åº”ç”¨ï¼ˆåŒ…æ‹¬å‰ç«¯ã€åç«¯å’ŒåŸºç¡€è®¾æ–½å®šä¹‰ï¼‰ã€‚

---

## ğŸ“‹ æ ¸å¿ƒæ”¹è¿›

### 1. ç³»ç»Ÿå®šä½å‡çº§

**ä¿®æ”¹å‰ï¼š**
- ä»…å°†å•ä½“åº”ç”¨çš„APIè·¯ç”±æ˜ å°„ä¸ºLambdaå‡½æ•°
- è¾“å‡ºç®€å•çš„ä»£ç ç‰‡æ®µ
- åŸºç¡€è®¾æ–½å®šä¹‰ä¸ä»£ç ä¸å®Œå…¨åŒ¹é…

**ä¿®æ”¹åï¼š**
- ç”Ÿæˆå®Œæ•´çš„å¯éƒ¨ç½²serverlessåº”ç”¨
- åŒ…å«å‰ç«¯å®Œæ•´åº”ç”¨ + Lambdaåç«¯ + SAMæ¨¡æ¿
- åŸºç¡€è®¾æ–½å®šä¹‰åŸºäºå®é™…ç”Ÿæˆçš„ä»£ç ç»“æ„

---

## ğŸ”„ AgentèŒè´£é‡æ–°å®šä¹‰

### Architect Agent (æ¶æ„å¸ˆ)

**ä¿®æ”¹å‰ï¼š**
- è§’è‰²ï¼šAWS Serverless Solutions Architect
- èŒè´£ï¼šç”Ÿæˆç®€å•çš„è“å›¾ï¼ˆLambda + DynamoDBï¼‰
- è¾“å‡ºï¼š`blueprint.json` (åŸºç¡€ç‰ˆ)

**ä¿®æ”¹åï¼š**
- è§’è‰²ï¼šAWS Serverless Migration Architect
- èŒè´£ï¼šè®¾è®¡**å®Œæ•´åº”ç”¨æ¶æ„**
- è¾“å‡ºï¼š`blueprint.json` (å¢å¼ºç‰ˆ)ï¼ŒåŒ…å«ï¼š
  - `backend_architecture`: Lambdaå‡½æ•°åˆ†ç»„ã€Step Functionsç¼–æ’ã€å…±äº«å±‚
  - `frontend_architecture`: éœ€è¦è¿ç§»çš„æ–‡ä»¶ã€éœ€è¦å¤åˆ¶çš„æ–‡ä»¶ã€æ–°é…ç½®æ–‡ä»¶
  - `data_architecture`: DynamoDBè¡¨å®Œæ•´schema
  - `auth_architecture`: Cognitoç”¨æˆ·æ± é…ç½®
  - `api_gateway`: REST APIé…ç½®å’ŒCORSè®¾ç½®

**å…³é”®å˜åŒ–ï¼š**
- ä»å•çº¯çš„åç«¯è®¾è®¡æ‰©å±•åˆ°å…¨æ ˆè®¾è®¡
- æ˜ç¡®å‰ç«¯è¿ç§»ç­–ç•¥ï¼ˆå“ªäº›æ–‡ä»¶æ”¹ï¼Œå“ªäº›æ–‡ä»¶å¤åˆ¶ï¼‰
- å¢åŠ æœåŠ¡ç¼–æ’è®¾è®¡ï¼ˆStep Functionsï¼‰

---

### Code Developer Agent (å®Œæ•´åº”ç”¨å¼€å‘è€…)

**ä¿®æ”¹å‰ï¼š**
- è§’è‰²ï¼šSenior Python/Node.js Developer
- èŒè´£ï¼šç”Ÿæˆå•ä¸ªLambdaå‡½æ•°å¤„ç†å™¨
- è¾“å‡ºï¼š`output/src/` (Lambda handlerä»£ç ç‰‡æ®µ)

**ä¿®æ”¹åï¼š**
- è§’è‰²ï¼šFull-Stack Serverless Application Developer
- èŒè´£ï¼šç”Ÿæˆ**å®Œæ•´å¯éƒ¨ç½²åº”ç”¨**
- è¾“å‡ºï¼šå®Œæ•´åº”ç”¨ç»“æ„
  ```
  output/
  â”œâ”€â”€ backend/
  â”‚   â”œâ”€â”€ lambdas/{lambda_name}/
  â”‚   â”‚   â”œâ”€â”€ handler.py
  â”‚   â”‚   â””â”€â”€ requirements.txt
  â”‚   â”œâ”€â”€ shared/ (å…±äº«å·¥å…·å‡½æ•°)
  â”‚   â”œâ”€â”€ layers/ (Lambdaå±‚)
  â”‚   â””â”€â”€ statemachines/ (Step Functionså®šä¹‰)
  â”œâ”€â”€ frontend/
  â”‚   â”œâ”€â”€ src/ (è¿ç§»åçš„å‰ç«¯ä»£ç )
  â”‚   â”œâ”€â”€ .env.example
  â”‚   â””â”€â”€ aws-exports.js
  â””â”€â”€ README.md (éƒ¨ç½²æŒ‡å—)
  ```

**å…³é”®å˜åŒ–ï¼š**
- ä»å•ä¸€Lambdaç”Ÿæˆæ‰©å±•åˆ°å®Œæ•´åº”ç”¨ç”Ÿæˆ
- åŒ…å«å‰ç«¯ä»£ç è¿ç§»ï¼ˆæ›¿æ¢ç¡¬ç¼–ç URLã€æ·»åŠ Cognitoé›†æˆï¼‰
- ç”Ÿæˆé…ç½®æ–‡ä»¶å’Œéƒ¨ç½²æ–‡æ¡£
- å¤„ç†å…±äº«ä»£ç å±‚å’ŒæœåŠ¡ç¼–æ’

---

### SAM Engineer Agent (åŸºç¡€è®¾æ–½ä»£ç ä¸“å®¶)

**ä¿®æ”¹å‰ï¼š**
- è§’è‰²ï¼šAWS SAM Expert (infra_engineer)
- èŒè´£ï¼šæ ¹æ®**blueprint**ç”ŸæˆSAMæ¨¡æ¿
- è¾“å‡ºï¼š`template.yaml`

**ä¿®æ”¹åï¼š**
- è§’è‰²ï¼šAWS SAM Infrastructure-as-Code Specialist (sam_engineer)
- èŒè´£ï¼šåˆ†æ**å®é™…ç”Ÿæˆçš„ä»£ç **ï¼Œç”ŸæˆåŒ¹é…çš„SAMæ¨¡æ¿
- è¾“å‡ºï¼š
  - `output/infrastructure/template.yaml` (ä¸»æ¨¡æ¿)
  - `output/infrastructure/cognito.yaml` (å¯é€‰ï¼šCognitoç‹¬ç«‹æ¨¡æ¿)
  - `output/infrastructure/parameters.json` (éƒ¨ç½²å‚æ•°)

**å…³é”®å˜åŒ–ï¼š**
- âš ï¸ **æœ€é‡è¦å˜åŒ–**ï¼šä»"åŸºäºblueprintç”Ÿæˆ"æ”¹ä¸º"åŸºäºå®é™…ä»£ç ç”Ÿæˆ"
- ä½¿ç”¨ `FileListTool` æ‰«æ `output/backend/lambdas/` ç›®å½•
- è¯»å–å®é™…çš„handleræ–‡ä»¶æ¥ç¡®å®šhandleråç§°å’Œè¿è¡Œæ—¶
- æ”¯æŒç”Ÿæˆå¤šä¸ªæ¨¡æ¿æ–‡ä»¶ï¼ˆä¸»æ¨¡æ¿ + Cognitoç­‰ç‹¬ç«‹æ¨¡æ¿ï¼‰
- å¢åŠ èµ„æºç±»å‹ï¼šLambda + API Gateway + DynamoDB + Step Functions + Cognito + Lambda Layers

---

## ğŸ› ï¸ æ–°å¢å·¥å…·

### 1. FileListTool
**æ–‡ä»¶ï¼š** `src/tools/file_tools.py`

**åŠŸèƒ½ï¼š**
- åˆ—å‡ºç›®å½•å†…å®¹ï¼ˆæ”¯æŒé€’å½’ï¼‰
- å¸®åŠ©SAM Engineeræ‰«æç”Ÿæˆçš„Lambdaç›®å½•ç»“æ„

**æ–¹æ³•ï¼š**
```python
file_list_tool.list_dir("output/backend/lambdas", recursive=False)
# è¿”å›: ["user_service/", "order_service/", ...]
```

---

### 2. SAMDocSearchTool
**æ–‡ä»¶ï¼š** `src/tools/sam_doc_tool.py`

**åŠŸèƒ½ï¼š**
- æä¾›AWS SAMæ–‡æ¡£å¿«é€ŸæŸ¥è¯¢
- æä¾›å¸¸ç”¨èµ„æºæ¨¡æ¿ç¤ºä¾‹
- æä¾›AWS SAMæœ€ä½³å®è·µ

**æ–¹æ³•ï¼š**
```python
sam_doc_tool.search("lambda")  # è¿”å›Lambdaå‡½æ•°æ–‡æ¡£å’Œç¤ºä¾‹æ¨¡æ¿
sam_doc_tool.search("dynamodb")  # è¿”å›DynamoDBè¡¨æ–‡æ¡£å’Œç¤ºä¾‹
sam_doc_tool.get_best_practices()  # è¿”å›SAMæœ€ä½³å®è·µ
```

---

## ğŸ“ é…ç½®æ–‡ä»¶å˜åŒ–

### agents.yaml
- **Architect**: æŒ‡ä»¤å¤§å¹…æ‰©å±•ï¼Œæ¶µç›–å…¨æ ˆæ¶æ„è®¾è®¡
- **Code Developer**: æ–°å¢6ä¸ªPhaseï¼ˆåç«¯Lambdaã€å…±äº«å±‚ã€Step Functionsã€å‰ç«¯è¿ç§»ã€é…ç½®æ–‡ä»¶ã€æ–‡æ¡£ï¼‰
- **SAM Engineer**: æ–°å¢ä»£ç åˆ†æPhaseï¼Œæ˜ç¡®"åˆ†æå®é™…ä»£ç "çš„è¦æ±‚

### tasks.yaml
- **Task 1** (architect_blueprint): å¢åŠ è¯¦ç»†çš„expected_outputæè¿°
- **Task 2** (generate_complete_application): 
  - ä» `code_generation` é‡å‘½å
  - è¯¦ç»†åˆ—å‡ºå‰åç«¯æ‰€æœ‰ç”Ÿæˆå†…å®¹
- **Task 3** (generate_sam_templates):
  - ä» `infra_template` é‡å‘½å
  - Agentä» `infra_engineer` æ”¹ä¸º `sam_engineer`
  - å¼ºè°ƒ"åˆ†æoutput/ç›®å½•"å’Œ"éªŒè¯ä¸ä»£ç ä¸€è‡´æ€§"

---

## ğŸ” å·¥ä½œæµå˜åŒ–

### ä¿®æ”¹å‰
```
é™æ€åˆ†æ â†’ Architectè®¾è®¡è“å›¾ â†’ ç”ŸæˆLambdaå‡½æ•° â†’ æ ¹æ®è“å›¾ç”ŸæˆSAM
```

### ä¿®æ”¹å
```
é™æ€åˆ†æ 
  â†“
Architectè®¾è®¡å®Œæ•´æ¶æ„ï¼ˆåŒ…æ‹¬å‰åç«¯ï¼‰
  â†“
Code Developerç”Ÿæˆå®Œæ•´åº”ç”¨
  â”œâ”€ åç«¯æ‰€æœ‰Lambdaå‡½æ•°
  â”œâ”€ å…±äº«ä»£ç å’Œå±‚
  â”œâ”€ Step Functionså®šä¹‰
  â”œâ”€ å‰ç«¯è¿ç§»ä»£ç 
  â”œâ”€ é…ç½®æ–‡ä»¶
  â””â”€ éƒ¨ç½²æ–‡æ¡£
  â†“
SAM Engineeråˆ†æç”Ÿæˆçš„ä»£ç 
  â”œâ”€ æ‰«æLambdaç›®å½•
  â”œâ”€ è¯»å–å®é™…handleræ–‡ä»¶
  â”œâ”€ ç”ŸæˆåŒ¹é…çš„SAMæ¨¡æ¿
  â””â”€ éªŒè¯æ¨¡æ¿ä¸ä»£ç ä¸€è‡´æ€§
  â†“
å®Œæ•´çš„å¯éƒ¨ç½²serverlessåº”ç”¨
```

---

## ğŸ“¦ è¾“å‡ºç»“æ„å¯¹æ¯”

### ä¿®æ”¹å‰
```
output/
â””â”€â”€ src/
    â””â”€â”€ lambda_handlers/
        â”œâ”€â”€ user_handler.py
        â””â”€â”€ order_handler.py
storage/
â”œâ”€â”€ blueprint.json
â””â”€â”€ template.yaml
```

### ä¿®æ”¹å
```
storage/
â””â”€â”€ blueprint.json  (æ¶æ„è“å›¾)

output/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ lambdas/
â”‚   â”‚   â”œâ”€â”€ user_service/
â”‚   â”‚   â”‚   â”œâ”€â”€ handler.py
â”‚   â”‚   â”‚   â””â”€â”€ requirements.txt
â”‚   â”‚   â””â”€â”€ order_service/
â”‚   â”‚       â”œâ”€â”€ handler.py
â”‚   â”‚       â””â”€â”€ requirements.txt
â”‚   â”œâ”€â”€ shared/
â”‚   â”‚   â”œâ”€â”€ db_utils.py
â”‚   â”‚   â””â”€â”€ auth_utils.py
â”‚   â”œâ”€â”€ layers/
â”‚   â”‚   â””â”€â”€ common_utils/
â”‚   â”‚       â””â”€â”€ python/shared/...
â”‚   â””â”€â”€ statemachines/
â”‚       â””â”€â”€ order_workflow.asl.json
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/ (è¿ç§»åï¼Œä½¿ç”¨envå˜é‡)
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ components/
â”‚   â”œâ”€â”€ .env.example
â”‚   â””â”€â”€ aws-exports.js
â”‚
â”œâ”€â”€ infrastructure/
â”‚   â”œâ”€â”€ template.yaml (ä¸»SAMæ¨¡æ¿)
â”‚   â”œâ”€â”€ cognito.yaml (Cognitoæ¨¡æ¿)
â”‚   â””â”€â”€ parameters.json (éƒ¨ç½²å‚æ•°)
â”‚
â””â”€â”€ README.md (å®Œæ•´éƒ¨ç½²æŒ‡å—)
```

---

## âœ… ä¿®æ”¹æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | çŠ¶æ€ | ä¸»è¦å˜åŒ– |
|------|------|----------|
| `src/config/agents.yaml` | âœ… ä¿®æ”¹ | ä¸‰ä¸ªagentçš„roleã€goalã€instructionså…¨éƒ¨é‡å†™ |
| `src/config/tasks.yaml` | âœ… ä¿®æ”¹ | ä¸‰ä¸ªtaskçš„descriptionå’Œexpected_outputè¯¦ç»†åŒ– |
| `src/main.py` | âœ… ä¿®æ”¹ | agentåç§°æ›´æ–°ã€æ·»åŠ æ–°å·¥å…·ã€å¢å¼ºè¾“å‡ºæç¤º |
| `src/tools/file_tools.py` | âœ… ä¿®æ”¹ | æ–°å¢ `FileListTool` ç±» |
| `src/tools/sam_doc_tool.py` | âœ… æ–°å¢ | AWS SAMæ–‡æ¡£æŸ¥è¯¢å·¥å…· |
| `src/tools/__init__.py` | âœ… ä¿®æ”¹ | å¯¼å‡ºæ–°å¢çš„å·¥å…·ç±» |

---

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. å‰ç½®å‡†å¤‡
```bash
# 1. é™æ€åˆ†æ
python src/preprocessor/static_analyzer.py --monolith-root input_monolith

# 2. æ„å»ºRAGç´¢å¼•
python src/preprocessor/build_rag.py --monolith-root input_monolith
```

### 2. è¿è¡Œè¿ç§»
```bash
python src/main.py
```

### 3. æŸ¥çœ‹ç»“æœ
- `storage/blueprint.json` - æ¶æ„è“å›¾
- `output/backend/` - åç«¯Lambdaå‡½æ•°
- `output/frontend/` - å‰ç«¯åº”ç”¨
- `output/infrastructure/` - SAMæ¨¡æ¿

### 4. éƒ¨ç½²åº”ç”¨
```bash
cd output
sam build
sam deploy --guided
```

---

## ğŸ¯ å…³é”®è®¾è®¡åŸåˆ™

### 1. å®Œæ•´æ€§åŸåˆ™
ä¸åªæ˜¯ä»£ç ç‰‡æ®µï¼Œè€Œæ˜¯å®Œæ•´çš„å¯éƒ¨ç½²åº”ç”¨ã€‚

### 2. ä¸€è‡´æ€§åŸåˆ™
SAMæ¨¡æ¿å¿…é¡»ä¸å®é™…ç”Ÿæˆçš„ä»£ç å®Œå…¨åŒ¹é…ã€‚

### 3. å¯è¿½æº¯åŸåˆ™
æ¯ä¸ªLambdaéƒ½èƒ½è¿½æº¯åˆ°åŸå•ä½“åº”ç”¨çš„æºæ–‡ä»¶ã€‚

### 4. æœ€ä½³å®è·µåŸåˆ™
åº”ç”¨AWS Well-Architected Frameworkå’ŒSAMæœ€ä½³å®è·µã€‚

### 5. ä¸šåŠ¡é€»è¾‘ä¿æŒåŸåˆ™
è¿ç§»è¿‡ç¨‹ä¸­ä¸æ”¹å˜ä¸šåŠ¡é€»è¾‘ï¼Œåªåšæ¶æ„é€‚é…ã€‚

---

## ğŸ“Š æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| åç«¯è¿è¡Œæ—¶ | Python 3.11 / Node.js 18.x |
| å‡½æ•°å¹³å° | AWS Lambda |
| APIç½‘å…³ | Amazon API Gateway (REST) |
| æ•°æ®åº“ | Amazon DynamoDB |
| è®¤è¯ | Amazon Cognito |
| ç¼–æ’ | AWS Step Functions |
| åŸºç¡€è®¾æ–½å³ä»£ç  | AWS SAM |
| å‰ç«¯æ‰˜ç®¡ | S3 + CloudFront (éƒ¨ç½²æ—¶) |

---

## ğŸ”§ åç»­ä¼˜åŒ–å»ºè®®

1. **å¢åŠ éªŒè¯Agent**: åœ¨éƒ¨ç½²å‰å¯¹ç”Ÿæˆçš„ä»£ç è¿›è¡Œè¯­æ³•æ£€æŸ¥å’Œå•å…ƒæµ‹è¯•
2. **å¢åŠ ä¼˜åŒ–Agent**: åˆ†æLambdaæ€§èƒ½ï¼Œå»ºè®®å†·å¯åŠ¨ä¼˜åŒ–
3. **å¢åŠ æˆæœ¬ä¼°ç®—**: æ ¹æ®ç”Ÿæˆçš„èµ„æºé¢„ä¼°AWSæˆæœ¬
4. **æ”¯æŒå¢é‡è¿ç§»**: æ”¯æŒéƒ¨åˆ†åŠŸèƒ½å…ˆè¿ç§»ï¼Œä¸å•ä½“å…±å­˜
5. **é›†æˆCI/CD**: è‡ªåŠ¨ç”ŸæˆGitHub Actionsæˆ–AWS CodePipelineé…ç½®

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [AWS SAM Documentation](https://docs.aws.amazon.com/serverless-application-model/)
- [AWS Lambda Best Practices](https://docs.aws.amazon.com/lambda/latest/dg/best-practices.html)
- [DynamoDB Best Practices](https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/best-practices.html)
- [CrewAI Documentation](https://docs.crewai.com/)

---

## âœ¨ æ€»ç»“

æ­¤æ¬¡å‡çº§å°†MAGç³»ç»Ÿä»ä¸€ä¸ª**ä»£ç æ˜ å°„å·¥å…·**æå‡ä¸º**å®Œæ•´åº”ç”¨è¿ç§»ç³»ç»Ÿ**ï¼Œæ ¸å¿ƒå˜åŒ–æ˜¯ï¼š

1. **Architect**: ä»ç®€å•è“å›¾ â†’ å®Œæ•´æ¶æ„è®¾è®¡ï¼ˆå‰åç«¯+æ•°æ®+è®¤è¯ï¼‰
2. **Code Developer**: ä»Lambdaå‡½æ•° â†’ å®Œæ•´åº”ç”¨ï¼ˆåç«¯+å‰ç«¯+é…ç½®+æ–‡æ¡£ï¼‰
3. **SAM Engineer**: ä»åŸºäºè“å›¾ â†’ åŸºäºå®é™…ä»£ç ç”ŸæˆåŸºç¡€è®¾æ–½

è¾“å‡ºä»"ä»£ç ç‰‡æ®µ"å˜ä¸º"å¼€ç®±å³ç”¨çš„serverlessåº”ç”¨"ï¼ŒçœŸæ­£å®ç°äº†ä»å•ä½“åˆ°äº‘åŸç”Ÿçš„ç«¯åˆ°ç«¯è¿ç§»ã€‚
