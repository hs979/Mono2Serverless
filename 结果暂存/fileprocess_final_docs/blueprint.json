{
  "metadata": {
    "application_name": "FileProcessing",
    "architecture_pattern": "Pattern 1: Simple REST API",
    "pattern_rationale": "The application primarily performs file processing (markdown to HTML conversion and sentiment analysis) with data storage in DynamoDB. It has no complex workflows, no real-time requirements, and no authentication needs. Pattern 1 is ideal for this type of CRUD-like application with simple request-response patterns."
  },
  "lambda_architecture": {
    "functions": [
      {
        "name": "FileProcessing-ConvertToHTML",
        "description": "Converts markdown files to HTML format",
        "runtime": "python3.9",
        "handler": "processing.convert_to_html",
        "memory": 256,
        "timeout": 30,
        "environment": {
          "OUTPUT_BUCKET": "${file-processing-output-bucket}"
        },
        "layers": ["FileProcessing-CommonLayer"]
      },
      {
        "name": "FileProcessing-AnalyzeSentiment",
        "description": "Analyzes sentiment of text content",
        "runtime": "python3.9",
        "handler": "processing.analyze_sentiment",
        "memory": 256,
        "timeout": 30,
        "layers": ["FileProcessing-CommonLayer"]
      },
      {
        "name": "FileProcessing-SaveSentiment",
        "description": "Saves sentiment analysis results to DynamoDB",
        "runtime": "python3.9",
        "handler": "database.save_sentiment",
        "memory": 256,
        "timeout": 30,
        "environment": {
          "SENTIMENT_TABLE": "${sentiment-analysis-table}"
        },
        "layers": ["FileProcessing-CommonLayer"]
      }
    ],
    "layers": [
      {
        "name": "FileProcessing-CommonLayer",
        "description": "Shared utilities and dependencies",
        "compatible_runtimes": ["python3.9"],
        "dependencies": ["markdown==3.3.6", "boto3>=1.26.0"]
      }
    ],
    "step_functions": null
  },
  "data_architecture": {
    "dynamodb_tables": [
      {
        "name": "sentiment-analysis-table",
        "description": "Stores sentiment analysis results for processed files",
        "partition_key": "filename",
        "partition_key_type": "S",
        "sort_key": null,
        "sort_key_type": null,
        "attributes": [
          {
            "name": "last_modified",
            "type": "S",
            "description": "Last modified timestamp"
          },
          {
            "name": "overall_sentiment",
            "type": "S",
            "description": "Overall sentiment (POSITIVE/NEGATIVE/NEUTRAL/MIXED)"
          },
          {
            "name": "positive",
            "type": "S",
            "description": "Positive sentiment score"
          },
          {
            "name": "negative",
            "type": "S",
            "description": "Negative sentiment score"
          },
          {
            "name": "neutral",
            "type": "S",
            "description": "Neutral sentiment score"
          },
          {
            "name": "mixed",
            "type": "S",
            "description": "Mixed sentiment score"
          }
        ],
        "billing_mode": "PAY_PER_REQUEST",
        "global_secondary_indexes": []
      }
    ],
    "s3_buckets": [
      {
        "name": "file-processing-input-bucket",
        "description": "Stores uploaded markdown files for processing",
        "lifecycle_rules": [
          {
            "id": "cleanup-old-files",
            "enabled": true,
            "prefix": "",
            "expiration_days": 30
          }
        ],
        "cors_configuration": {
          "AllowedOrigins": ["*"],
          "AllowedMethods": ["GET", "PUT", "POST", "DELETE"],
          "AllowedHeaders": ["*"]
        }
      },
      {
        "name": "file-processing-output-bucket",
        "description": "Stores processed HTML files and analysis results",
        "lifecycle_rules": [
          {
            "id": "cleanup-old-files",
            "enabled": true,
            "prefix": "",
            "expiration_days": 90
          }
        ],
        "cors_configuration": {
          "AllowedOrigins": ["*"],
          "AllowedMethods": ["GET"],
          "AllowedHeaders": ["*"]
        }
      }
    ]
  },
  "auth_architecture": {
    "cognito_user_pools": null,
    "authentication_required": false,
    "authentication_rationale": "No authentication functions detected in analysis. The application appears to be a backend processing service without user management requirements."
  },
  "api_gateway": {
    "type": "REST_API",
    "description": "REST API for file processing operations",
    "cors": {
      "allow_origins": ["*"],
      "allow_methods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
      "allow_headers": ["Content-Type", "X-Amz-Date", "Authorization", "X-Api-Key"],
      "max_age": 86400
    },
    "stages": ["dev", "prod"],
    "throttling": {
      "rate_limit": 1000,
      "burst_limit": 2000
    },
    "resources": [
      {
        "path": "/files",
        "methods": ["POST"],
        "integration": "FileProcessing-ConvertToHTML",
        "description": "Upload and convert markdown files to HTML"
      },
      {
        "path": "/files/{filename}/sentiment",
        "methods": ["POST"],
        "integration": "FileProcessing-AnalyzeSentiment",
        "description": "Analyze sentiment of file content"
      },
      {
        "path": "/sentiment/{filename}",
        "methods": ["GET"],
        "integration": "FileProcessing-SaveSentiment",
        "description": "Retrieve sentiment analysis results"
      }
    ]
  },
  "integration_patterns": {
    "services": [],
    "rationale": "No evidence of complex event routing, background jobs, or multi-step workflows in analysis. Simple REST API pattern sufficient for current requirements."
  },
  "monitoring": {
    "cloudwatch_logs": {
      "retention_days": 30,
      "log_groups": [
        {
          "name": "/aws/lambda/FileProcessing-ConvertToHTML",
          "retention_days": 30
        },
        {
          "name": "/aws/lambda/FileProcessing-AnalyzeSentiment",
          "retention_days": 30
        },
        {
          "name": "/aws/lambda/FileProcessing-SaveSentiment",
          "retention_days": 30
        }
      ]
    },
    "cloudwatch_alarms": [
      {
        "name": "FileProcessing-HighErrorRate",
        "metric": "Errors",
        "namespace": "AWS/Lambda",
        "threshold": 5,
        "period": 300,
        "evaluation_periods": 2,
        "comparison_operator": "GreaterThanThreshold",
        "alarm_actions": ["arn:aws:sns:us-east-1:123456789012:FileProcessing-Alerts"]
      },
      {
        "name": "FileProcessing-HighLatency",
        "metric": "Duration",
        "namespace": "AWS/Lambda",
        "threshold": 10000,
        "period": 300,
        "evaluation_periods": 2,
        "comparison_operator": "GreaterThanThreshold",
        "alarm_actions": ["arn:aws:sns:us-east-1:123456789012:FileProcessing-Alerts"]
      }
    ],
    "xray_tracing": {
      "enabled": true,
      "sampling_rate": 0.05
    }
  },
  "dropped_functions": [
    {
      "function": "init_dynamodb.py",
      "reason": "Infrastructure script - should be handled by CloudFormation/CDK for table creation"
    },
    {
      "function": "get_dynamodb_client",
      "reason": "Infrastructure utility - boto3 client initialization handled by Lambda runtime"
    },
    {
      "function": "table_exists",
      "reason": "Infrastructure utility - table management handled by CloudFormation/CDK"
    },
    {
      "function": "wait_for_table",
      "reason": "Infrastructure utility - table management handled by CloudFormation/CDK"
    },
    {
      "function": "create_sentiment_table",
      "reason": "Infrastructure script - should be handled by CloudFormation/CDK for table creation"
    }
  ]
}