{"docstore/metadata": {"1768ec30-2fe6-41c6-8941-0b1476bde852": {"doc_hash": "3193ed17a88f96b59ba0b1ffc2cd11b87abe35d19a2d2a71aba36eb73960f042"}, "5c230dea-11c4-4eb6-9763-f290412b99e1": {"doc_hash": "6c220ab943b95036f84468bf0e66caefaa04df76da565e29e886e63ce0c5cfb3"}, "28145676-f521-4f08-bae5-ca75328fb6bc": {"doc_hash": "ba5709018df355be3a944c977227db63280f890c56e27b1502f2422f17bb2da8"}, "f184d9c8-7261-4567-b8a3-59f11fee99b0": {"doc_hash": "d9656bf486233c9ee082d34016380ce9b1e4cc56a14f33dd32d32440875357d6"}, "d8cdbe46-415d-44f5-a7bd-70709f02c911": {"doc_hash": "939f49fabb02e9693456b1b08a035dbe7ce1511163f2a88fa4dc519e7ddfaac2"}, "936cb1b1-76b8-4b16-bfc0-e519ba7147bd": {"doc_hash": "d5ee178c6f667b72788e9031653777c5545d25f1f6bc8bc55aeb747df682fcc9"}, "2645ebb7-6990-4655-b7b5-30be699c1e53": {"doc_hash": "4258304d748cb5250cced15132ade0726c5a37b60c8288d1799614af4431295d"}, "3f568699-6bdd-47d4-87ff-c4288b7f3c3d": {"doc_hash": "8212c5d323957de791c90dbff1298c5192db6aecb0f6639446c9e7b232dc7808"}, "60ebec05-5949-4f21-a54f-9fe65b70804c": {"doc_hash": "73a75cd2115df03899865d71d6840d35990eb8570b2f06b63c7bbff6c2b7d6dd"}, "fff8de69-ce5f-400d-870d-81927a768a3d": {"doc_hash": "22e1cab6cf4521f79dd16596e6f119a7af00b2db5a3be815b8e7e60f9fe93bc8"}, "bc8aa823-7830-4165-a18f-58b5b43c514c": {"doc_hash": "9dbe4ffc91b5bfd1f5bf0402d3fb747e5e5060f81a771fd3d608e805835b93c0"}, "0c4272ce-252e-4006-9465-4989f4ab736b": {"doc_hash": "f6b836d9cfe5e2988f60494d28f676d5269035b6c1a6112326443b241ed2f8e9"}, "e1a9abd9-8735-4709-a8f7-304b117a3b24": {"doc_hash": "e231a3d19fe68123443b444396c48b2e1ed4fe04cbc1ec0d88b390af3807462e"}, "923a6b62-55f2-40a1-9675-8bd7aff11ad5": {"doc_hash": "3866b6e54dcc6c6982765058726c08bae34192bebd52854b48f0562cb3f4cd7d"}, "268be702-dfb4-4ac1-8b64-7699798f068e": {"doc_hash": "66e188c7ae6278aca990d848ce42063556cd2c78a20910da084c802b07ab0404"}, "6ab3e1e4-f796-44b9-9836-f84b677b3ce9": {"doc_hash": "4a94766901816ff561fe5b6ab8b93b1c72b2e809b078b816473d0681b907a4a0"}, "b0ad6760-6d57-4923-ba79-6f313f6280fb": {"doc_hash": "ec3978eab1ea09130f9b8299e153564c2831f578929bf1dd5fbd7a7445ea5fc8"}, "34003c8e-ac99-4ad8-9764-63eb13ad7928": {"doc_hash": "2f43364ba9c55e72bed5c01d09d596950f2799ee6d5f49d2816c47275a2af21e"}, "3379f98f-8bfd-44ed-9c20-7c62640922ff": {"doc_hash": "4265bb2929e107c6f172a533efc21876abc71ba83d1f6d1f1e212d3bd7a23b39"}, "0116dbf0-3f46-48a5-93ae-afe91aa9b9d4": {"doc_hash": "40204a5361a7291831994aea6eb2bdfc4a338797c777e6f75412790c5eb55b17"}, "d538911d-558c-4d48-b5ca-bf267a2c86f0": {"doc_hash": "8884357837cc5866fd57fc27278d16c594a2f08dc69e03e4b92f18782a041d64"}, "b0c12d3a-e10d-40e7-83d8-aeddb62b1c0a": {"doc_hash": "daa2a22f380742be595ae9c5deac211106c13c5e72d37091e3ebc345df8fd5a6"}, "2c077db2-f4f1-4995-8dee-3bfd91fac48c": {"doc_hash": "478dcc4bbb04bd59ffa89ffd2545f20a6221d973de0c948f0b18853d5e443dae"}, "97c80875-0fa0-43fc-97ac-c2b31eb0ca79": {"doc_hash": "01d9134e28f34dea06943e104bafc46efe133cab5e4500f6f95f9c1ff5c7022d"}, "b0800a97-f1b0-4589-ac7a-7facbd0abcdc": {"doc_hash": "a0443b65ccfb71f775d67bd08cc1c6c168863833a1fd075db6ea23e8ec0c19e1"}, "68143e68-3de7-4e2a-b301-69cc2d865e17": {"doc_hash": "b18d80cf20c6be7d07d7c5d6c446a05d0acf235dd5fe9508e4107880d2c3d41c"}, "a53d8556-45a8-4b52-88c2-f79fbe5b1c18": {"doc_hash": "03553a358a4df863b28bf6f693083deb649e3926f16229385d5164b5205adc75"}, "14b7bf22-5c83-46b9-a79d-5144cde02583": {"doc_hash": "c32bbd144a068fdb445185baf185c6060db1ceef0ac96a02e944530fe73c6ccc"}, "2c4eb6f7-b7a7-4600-8ba8-2fb57fff9c53": {"doc_hash": "1f771e0d4a253490e1687b0d5bc25906d91f32bfcc380951cdadedad9dd4c86a"}, "83e9b36c-4347-42e7-ad10-7100a6413811": {"doc_hash": "3489b6ef73f33ebab51dce110399c11dfae76808ee8d546ef6930938209eae01"}, "35f228f7-8adb-4f50-b0e3-be7c1ac4f766": {"doc_hash": "ad25146250fe5f86a6c8482cfed6841a016b324e368811e8ab12d2ed991ba070"}, "864e20e7-b528-450a-b664-5ca9d7a023cd": {"doc_hash": "537d1b562e9a7b165c50cf70b7e52462a0c6fc81f4cc4e2d03683c9d77d06a9f"}, "16bcc082-baab-4e9a-941b-0ab5565ba9f0": {"doc_hash": "cab50050c66a350bcb666c8a802691809410e0108d84cc7ee2755cb89a2532da"}, "7d8c2056-a7b8-4921-98cb-976d32af1bf3": {"doc_hash": "e718e45161e0889d372254355a7c6ddc25c59250d2780c73f2582cfb39d2c562"}, "421ca100-6d2f-48c4-b32a-d9c2ad2aa3c7": {"doc_hash": "e193ef0a04f8313fb535b78baa00e8bd8db6cb77190bdbb21457780dc884a8dc"}, "5a43127c-ecbf-43fd-b4d3-365bd6c41f72": {"doc_hash": "40970fb64349466e3b221d52a364f7b26747fcfa886e1ca5e44e7bedcd34e4c0"}, "6da7c430-5a30-48b1-a86e-a2f72616e8f4": {"doc_hash": "2ad6ad8b9a86d07c0165eedc98e2b394a76a6ac18818383cc8bfba7ac8c282c8"}, "7f9c2fe6-62f5-412e-81bf-69cac9a6cc10": {"doc_hash": "642523e903f8bd81d4edc20342d1334714120f8465bbcc6fb39e7c2911795c25"}, "f92a48ff-36ed-45e4-99e6-e81a7099df4b": {"doc_hash": "91f31d8bc68c496d0541a668ebbe73acbf373da1528f333b8bf63c4a9d577790"}, "52c1491d-f736-4512-8345-02833a9dce21": {"doc_hash": "2bb54f5f2badf6c82b27479e36a54f146bd643f03383e0e6e9aa5d9089732aa7"}, "1ccdfadd-b678-47ab-9f23-3580fb18509d": {"doc_hash": "7a5e5438928de6be3318ee5a1f0d56882099e6e34a3b3b76c23920b5b3432f25"}, "97275af1-e424-4951-8227-08dea6ced84d": {"doc_hash": "9ae65235632fb3d015c94a76ff36dcaa8a4606f737a7d49d42fe5aaf1009f7cf"}, "14f02a56-7657-4499-8046-2c2664bcc6b1": {"doc_hash": "75ead7167ee17e0dc14b8d6ef75e023547a5adf52fae0b184906523dbefce086"}, "5cf83985-6982-4b86-9037-6ff48460dcf0": {"doc_hash": "8fdb08383b22a744bda4432ad73e2e66dd6f1226c4fb3d74c7834fe5de19df8b"}, "39df17a6-3479-4878-ab69-d966a7954d1d": {"doc_hash": "9809f14f8e8e773aea6fa53fa9a48ea55550eea2a43e445f38a455a9bc70de73"}, "56fabde6-6c71-4da5-aa03-d5c9bbde0fb2": {"doc_hash": "247d9f3370d246ffa76176ba5c6ccb1908a9deece33dcd1a61758ca2c3e9b65d"}, "891d0708-3cde-46b0-a8b6-0219e474cd92": {"doc_hash": "a8428da1c01e22e36e6631b518ae0ad8fd019612b2874709f6f171382f263d6a"}, "6d6f9394-ad72-42b9-baea-92ffad7651ed": {"doc_hash": "11cfa4b4103ea29a710b123ed3b1b7f8074af5e8d3d87e43e122903397dd42f7", "ref_doc_id": "1768ec30-2fe6-41c6-8941-0b1476bde852"}, "e349abb4-5cd2-4cbf-9bc3-4ed8e2a8a15a": {"doc_hash": "4ece16fa6c4a5d0b1fbf400a0f3d1ec40fdb2a5061d7e8a3b4477878818e2d19", "ref_doc_id": "5c230dea-11c4-4eb6-9763-f290412b99e1"}, "5937904d-77ea-41cd-bb18-e5eeecf8d1f1": {"doc_hash": "dd55989f42f487fb4498af72ad91450d4a15f7d42afd96861a1d887365a27bf5", "ref_doc_id": "28145676-f521-4f08-bae5-ca75328fb6bc"}, "e4a58967-cb53-44a2-8174-ebc2cc5936cd": {"doc_hash": "4b86223e471ac3d70b84d74f66bb1761e73c28cca5f00d59418892082a4dd5c6", "ref_doc_id": "f184d9c8-7261-4567-b8a3-59f11fee99b0"}, "db95a299-e067-404d-a1a3-f782c870fadf": {"doc_hash": "50fa062592c13ed81371849b150a68343bb57feba71d43b858a9c6e6d663f003", "ref_doc_id": "d8cdbe46-415d-44f5-a7bd-70709f02c911"}, "a2f440fd-c262-4058-a745-490fbd2023eb": {"doc_hash": "f11e9e8f41ee6a1757efa69563e8208df454ac017df1944f03ac694c05a83113", "ref_doc_id": "936cb1b1-76b8-4b16-bfc0-e519ba7147bd"}, "42cfaa63-10e4-4d6c-833a-7e56d5bf7551": {"doc_hash": "5a137b81e471b23376c7a395aadfab2a0d80992a5aad115796d40e70e8511a04", "ref_doc_id": "2645ebb7-6990-4655-b7b5-30be699c1e53"}, "5d56eeab-ee74-4b53-9696-306e32e001ff": {"doc_hash": "d0ecc40afee61f22e1daf611b65fd2bc7c06b6d818fc650ad6b76913e5775bbe", "ref_doc_id": "3f568699-6bdd-47d4-87ff-c4288b7f3c3d"}, "1c2e63a5-87c5-4cf4-b876-f1789b638b2c": {"doc_hash": "4b5f8895358b1b9302862df142c7898ea1b73fd5f62e10e1c3bd9b0576bac685", "ref_doc_id": "60ebec05-5949-4f21-a54f-9fe65b70804c"}, "64594dc3-1330-4501-9617-8e9b6b27f2ba": {"doc_hash": "3aaefa8ebc85c35ec14435f4c12a6dcacb5893c11e1a65fa058d08c9b83a8748", "ref_doc_id": "fff8de69-ce5f-400d-870d-81927a768a3d"}, "9aab8f03-4f67-48b4-bc82-28656fb015be": {"doc_hash": "36202c470d7647851e23d11066b337b48510e3dfc679ecab540472cd7330c7d8", "ref_doc_id": "bc8aa823-7830-4165-a18f-58b5b43c514c"}, "28a4e7f6-ed37-448f-9aeb-5f9870d4a08b": {"doc_hash": "858f8044fbe91c1b0882372d240e82b2b086d6890976c53e35ed937f14521e39", "ref_doc_id": "0c4272ce-252e-4006-9465-4989f4ab736b"}, "7e4d33a7-1858-4cc2-81b1-09189f1f3e24": {"doc_hash": "b819588691ddf15b6aa2af09d355ebf07c322b33727b0b2bc6d64e71cfb8b6a5", "ref_doc_id": "e1a9abd9-8735-4709-a8f7-304b117a3b24"}, "f388308b-a2a4-41bc-87da-9e80127eb15a": {"doc_hash": "0e72b48ca21d521d45f6a460b80c4229dfd07509f005ac05aff0af75da495b10", "ref_doc_id": "923a6b62-55f2-40a1-9675-8bd7aff11ad5"}, "c97ea4df-f9f2-44d9-9891-9be4a4065da9": {"doc_hash": "6f6df65114d32deacca414cdd9d112919d4baa43d66e7abb37f2963d560c8908", "ref_doc_id": "268be702-dfb4-4ac1-8b64-7699798f068e"}, "a6e22085-676e-48d6-8025-8f9b75661a04": {"doc_hash": "2e81d19aae9b98af33fac8c34bc932fc35a5ee83674c14cd77854160804ae4fd", "ref_doc_id": "6ab3e1e4-f796-44b9-9836-f84b677b3ce9"}, "d52e7449-0fab-4d87-9265-084f4f4846c1": {"doc_hash": "7b046a63fbd7f0e16921ca3642103baf7171355a5027127ddd66f827fb598cc6", "ref_doc_id": "b0ad6760-6d57-4923-ba79-6f313f6280fb"}, "1bcbf916-657d-46e2-8d2a-91d5e1725025": {"doc_hash": "44b128c46dfbd90e0a7eeb240f64f7ff45135240ef4b427015fdce45f6071883", "ref_doc_id": "34003c8e-ac99-4ad8-9764-63eb13ad7928"}, "6e3f2c44-c60c-4121-96ed-abd553b73a85": {"doc_hash": "d1ef9d87346e1f248fd841a3763cd05c892d3a8703a4d283aa642fd04c5cbddd", "ref_doc_id": "3379f98f-8bfd-44ed-9c20-7c62640922ff"}, "bd7cd9f1-b9a4-4646-a910-3e38469dc9e4": {"doc_hash": "57ebf463130a0ded22b8e11cccfc5d01745b4204ff62b5eb95083a7dc3972fb4", "ref_doc_id": "0116dbf0-3f46-48a5-93ae-afe91aa9b9d4"}, "4b91b304-541e-42fd-b52e-f28fdf72fe8f": {"doc_hash": "0e040744b7aed0a412485403b144022bf76060459e0f0ccc153c3bc15c4beaed", "ref_doc_id": "d538911d-558c-4d48-b5ca-bf267a2c86f0"}, "46842e5c-b0fb-4a89-8ecb-5916e43e360f": {"doc_hash": "6b62f54a387c87363079740712afd3d97970251f5f5b9a6c0a83b024d6c7a9d5", "ref_doc_id": "b0c12d3a-e10d-40e7-83d8-aeddb62b1c0a"}, "273089d2-a840-44a0-b980-82733e1f9699": {"doc_hash": "25b6071e810fd3843aa159d6216803a4c2e423ee9b1dd89d51588faccdf2284c", "ref_doc_id": "2c077db2-f4f1-4995-8dee-3bfd91fac48c"}, "330b9aa6-5ff8-49bf-a0ad-25939e0a28b9": {"doc_hash": "75993defaa2486f8134e900be00c18ea3e3fc874df9b8b8591da26c333e867fb", "ref_doc_id": "97c80875-0fa0-43fc-97ac-c2b31eb0ca79"}, "253b5a6c-4dc0-40bb-be4c-77635ce1f111": {"doc_hash": "a9dcd55ba84b774dd223d97d7aeb024c100c06aa7c4be52324dbc2c906b593b0", "ref_doc_id": "b0800a97-f1b0-4589-ac7a-7facbd0abcdc"}, "0f370229-563d-47ed-9b8a-117f250fffcd": {"doc_hash": "ad37a901ff76a9c7452118f007c64d19bbc31980711c7f094fcf6a924cca28ad", "ref_doc_id": "68143e68-3de7-4e2a-b301-69cc2d865e17"}, "5213e89a-23fb-464f-8d8a-17c35e5ffb28": {"doc_hash": "9ce5e153e65b6251c85ab8dba9e8d3a13a98aaf85c8ffa3aeee9f4f765fe04f6", "ref_doc_id": "a53d8556-45a8-4b52-88c2-f79fbe5b1c18"}, "eed7eac8-7256-4842-8b81-474c0ed73e7e": {"doc_hash": "9fbcd88192d956fc2fa386bbabecde9240e806dc13c51c258146b068976d26d8", "ref_doc_id": "14b7bf22-5c83-46b9-a79d-5144cde02583"}, "49901916-bfcd-4da9-8649-8a8bd28b7097": {"doc_hash": "bc046d22e1612ca99e99de6bc0ad21bb1f48904c028977ae9d4e1d2a04ef2389", "ref_doc_id": "2c4eb6f7-b7a7-4600-8ba8-2fb57fff9c53"}, "a36389c5-c4c7-46f0-a14c-5427b3e021b5": {"doc_hash": "a11340a36d605a9668e6a8770b34b3e4e0be90bd5419b594e31d37b09bd2482c", "ref_doc_id": "83e9b36c-4347-42e7-ad10-7100a6413811"}, "e3e79a60-de2b-4296-8a0f-3aaba6f760e8": {"doc_hash": "31ac6af3cd2af304b6c6c6e384e3323177ab307dfe3b9a64e9c27990e71834a0", "ref_doc_id": "35f228f7-8adb-4f50-b0e3-be7c1ac4f766"}, "12de9655-afdb-49af-b9b2-702c9318eaaf": {"doc_hash": "8cafa772676d6d5e1d7d5984355be84c1d00b8e50e662ce32980cd22c2139f28", "ref_doc_id": "864e20e7-b528-450a-b664-5ca9d7a023cd"}, "f77f7f93-ca10-4c13-93bc-9ed41100ffd1": {"doc_hash": "e39a39c903954f409c270599cf94c1d5fea3326e9ba1851b1c30911409113851", "ref_doc_id": "16bcc082-baab-4e9a-941b-0ab5565ba9f0"}, "f4db15e3-1f78-4321-97eb-3f77eb5cadf6": {"doc_hash": "58699ab84443bfd122d2260db96b26eed81e92717e4326f68974f0fd5d99aee7", "ref_doc_id": "7d8c2056-a7b8-4921-98cb-976d32af1bf3"}, "4f31569f-2c1d-4a4b-87a8-468cb7b3e9c8": {"doc_hash": "cf32b1eef5905c27df206db5b0c2d31d764a511a1f3e30088fe7fbed14ea931e", "ref_doc_id": "421ca100-6d2f-48c4-b32a-d9c2ad2aa3c7"}, "eba260d9-17ac-44e2-8454-0a802055bc27": {"doc_hash": "73c9c46dc459e93dd1a21814b37a246d1b4bbf9672fb0d6243850ab2ad8c0db0", "ref_doc_id": "5a43127c-ecbf-43fd-b4d3-365bd6c41f72"}, "bc25adfb-2067-40ab-9745-98c98f4f5709": {"doc_hash": "5cf13945cab579d900aaabd650374f51931bb107c1d77cbae56a8981ad14f001", "ref_doc_id": "6da7c430-5a30-48b1-a86e-a2f72616e8f4"}, "67f650ad-6702-4a49-933d-548459110d6c": {"doc_hash": "7ff23971a1a46413d2f871dfb6039a1c7789c46c8c867a7e189547fa6b130881", "ref_doc_id": "7f9c2fe6-62f5-412e-81bf-69cac9a6cc10"}, "ecbdfc95-d678-44b2-85a7-729058938a8e": {"doc_hash": "f1ad0a18dc398c2882c4dbc9330bb6c4b3065a57b344f3d4a7446b8235292044", "ref_doc_id": "f92a48ff-36ed-45e4-99e6-e81a7099df4b"}, "60471ab0-e28e-4ecc-a552-2b27433f01c7": {"doc_hash": "4dd136a7fa7f14c4758413d04b6e5a3f8367da02749341bc71fd0458d184e959", "ref_doc_id": "52c1491d-f736-4512-8345-02833a9dce21"}, "5168c827-fd02-433b-8ce9-a89135567bfb": {"doc_hash": "5acdee6ec94d7e5447ee86024f9c0677ebc51a20dc1db9af952238679007d5a3", "ref_doc_id": "1ccdfadd-b678-47ab-9f23-3580fb18509d"}, "87bd9e78-18ba-484c-a152-f7c4155c1e71": {"doc_hash": "190c3d2b7d481c903e5b2d7a3ef9de1af25141bd8511c074598d95bb2544d023", "ref_doc_id": "97275af1-e424-4951-8227-08dea6ced84d"}, "343d7ca2-d5fc-43fc-b968-32b6b8af11cb": {"doc_hash": "e2b519ef127ae2d8d818cc53c0932e4a6e346be86ba3bb43b3bdb0fd9668685b", "ref_doc_id": "14f02a56-7657-4499-8046-2c2664bcc6b1"}, "89a02f03-33fa-4ffd-aebd-341c00973994": {"doc_hash": "110fab500b6373ac8bdf05463acc8d5d2f46e62f352510574116d4f0470e05e1", "ref_doc_id": "5cf83985-6982-4b86-9037-6ff48460dcf0"}, "8583bc50-f980-4145-bbfe-37b65cb0f93d": {"doc_hash": "312095a6ab32ca820d08afc3ff0fc884446282384e134ed983685b09efea87d6", "ref_doc_id": "39df17a6-3479-4878-ab69-d966a7954d1d"}, "69da2980-2203-438a-86b1-6279e151b499": {"doc_hash": "b7071dce0ed4044025a5f2ad48a927cc1b293cfed70b2eb81ca8b14439882e54", "ref_doc_id": "56fabde6-6c71-4da5-aa03-d5c9bbde0fb2"}, "31d7768f-47fd-4752-986a-98426498c1bf": {"doc_hash": "e78c99e55eb08d5b68585e5908163c9c045ef9edca3a96af95d0a4c43bffe536", "ref_doc_id": "891d0708-3cde-46b0-a8b6-0219e474cd92"}}, "docstore/ref_doc_info": {"1768ec30-2fe6-41c6-8941-0b1476bde852": {"node_ids": ["6d6f9394-ad72-42b9-baea-92ffad7651ed"], "metadata": {"file_path": "backend/app.py", "function_name": "get_cart_id_from_cookie", "symbol_id": "backend.app.get_cart_id_from_cookie", "type": "function", "start_line": 52, "end_line": 59}}, "5c230dea-11c4-4eb6-9763-f290412b99e1": {"node_ids": ["e349abb4-5cd2-4cbf-9bc3-4ed8e2a8a15a"], "metadata": {"file_path": "backend/app.py", "function_name": "set_cart_cookie", "symbol_id": "backend.app.set_cart_cookie", "type": "function", "start_line": 62, "end_line": 73}}, "28145676-f521-4f08-bae5-ca75328fb6bc": {"node_ids": ["5937904d-77ea-41cd-bb18-e5eeecf8d1f1"], "metadata": {"file_path": "backend/app.py", "function_name": "login_required", "symbol_id": "backend.app.login_required", "type": "function", "start_line": 76, "end_line": 95}}, "f184d9c8-7261-4567-b8a3-59f11fee99b0": {"node_ids": ["e4a58967-cb53-44a2-8174-ebc2cc5936cd"], "metadata": {"file_path": "backend/app.py", "function_name": "decorated_function", "symbol_id": "backend.app.decorated_function", "type": "function", "start_line": 79, "end_line": 93}}, "d8cdbe46-415d-44f5-a7bd-70709f02c911": {"node_ids": ["db95a299-e067-404d-a1a3-f782c870fadf"], "metadata": {"file_path": "backend/app.py", "function_name": "get_user_identifier", "symbol_id": "backend.app.get_user_identifier", "type": "function", "start_line": 98, "end_line": 110}}, "936cb1b1-76b8-4b16-bfc0-e519ba7147bd": {"node_ids": ["a2f440fd-c262-4058-a745-490fbd2023eb"], "metadata": {"file_path": "backend/app.py", "function_name": "register", "symbol_id": "backend.app.register", "type": "function", "start_line": 116, "end_line": 136}}, "2645ebb7-6990-4655-b7b5-30be699c1e53": {"node_ids": ["42cfaa63-10e4-4d6c-833a-7e56d5bf7551"], "metadata": {"file_path": "backend/app.py", "function_name": "login", "symbol_id": "backend.app.login", "type": "function", "start_line": 140, "end_line": 162}}, "3f568699-6bdd-47d4-87ff-c4288b7f3c3d": {"node_ids": ["5d56eeab-ee74-4b53-9696-306e32e001ff"], "metadata": {"file_path": "backend/app.py", "function_name": "get_products", "symbol_id": "backend.app.get_products", "type": "function", "start_line": 168, "end_line": 170}}, "60ebec05-5949-4f21-a54f-9fe65b70804c": {"node_ids": ["1c2e63a5-87c5-4cf4-b876-f1789b638b2c"], "metadata": {"file_path": "backend/app.py", "function_name": "get_product", "symbol_id": "backend.app.get_product", "type": "function", "start_line": 174, "end_line": 181}}, "fff8de69-ce5f-400d-870d-81927a768a3d": {"node_ids": ["64594dc3-1330-4501-9617-8e9b6b27f2ba"], "metadata": {"file_path": "backend/app.py", "function_name": "list_cart", "symbol_id": "backend.app.list_cart", "type": "function", "start_line": 187, "end_line": 205}}, "bc8aa823-7830-4165-a18f-58b5b43c514c": {"node_ids": ["9aab8f03-4f67-48b4-bc82-28656fb015be"], "metadata": {"file_path": "backend/app.py", "function_name": "add_to_cart", "symbol_id": "backend.app.add_to_cart", "type": "function", "start_line": 209, "end_line": 248}}, "0c4272ce-252e-4006-9465-4989f4ab736b": {"node_ids": ["28a4e7f6-ed37-448f-9aeb-5f9870d4a08b"], "metadata": {"file_path": "backend/app.py", "function_name": "update_cart", "symbol_id": "backend.app.update_cart", "type": "function", "start_line": 252, "end_line": 305}}, "e1a9abd9-8735-4709-a8f7-304b117a3b24": {"node_ids": ["7e4d33a7-1858-4cc2-81b1-09189f1f3e24"], "metadata": {"file_path": "backend/app.py", "function_name": "migrate_cart", "symbol_id": "backend.app.migrate_cart", "type": "function", "start_line": 310, "end_line": 334}}, "923a6b62-55f2-40a1-9675-8bd7aff11ad5": {"node_ids": ["f388308b-a2a4-41bc-87da-9e80127eb15a"], "metadata": {"file_path": "backend/app.py", "function_name": "checkout_cart", "symbol_id": "backend.app.checkout_cart", "type": "function", "start_line": 339, "end_line": 365}}, "268be702-dfb4-4ac1-8b64-7699798f068e": {"node_ids": ["c97ea4df-f9f2-44d9-9891-9be4a4065da9"], "metadata": {"file_path": "backend/app.py", "function_name": "get_cart_total", "symbol_id": "backend.app.get_cart_total", "type": "function", "start_line": 369, "end_line": 379}}, "6ab3e1e4-f796-44b9-9836-f84b677b3ce9": {"node_ids": ["a6e22085-676e-48d6-8025-8f9b75661a04"], "metadata": {"file_path": "backend/app.py", "function_name": "serve_frontend", "symbol_id": "backend.app.serve_frontend", "type": "function", "start_line": 386, "end_line": 406}}, "b0ad6760-6d57-4923-ba79-6f313f6280fb": {"node_ids": ["d52e7449-0fab-4d87-9265-084f4f4846c1"], "metadata": {"file_path": "backend/app.py", "function_name": "internal_error", "symbol_id": "backend.app.internal_error", "type": "function", "start_line": 412, "end_line": 414}}, "34003c8e-ac99-4ad8-9764-63eb13ad7928": {"node_ids": ["1bcbf916-657d-46e2-8d2a-91d5e1725025"], "metadata": {"file_path": "backend/auth.py", "function_name": "create_token", "symbol_id": "backend.auth.create_token", "type": "function", "start_line": 17, "end_line": 36}}, "3379f98f-8bfd-44ed-9c20-7c62640922ff": {"node_ids": ["6e3f2c44-c60c-4121-96ed-abd553b73a85"], "metadata": {"file_path": "backend/auth.py", "function_name": "verify_token", "symbol_id": "backend.auth.verify_token", "type": "function", "start_line": 39, "end_line": 59}}, "0116dbf0-3f46-48a5-93ae-afe91aa9b9d4": {"node_ids": ["bd7cd9f1-b9a4-4646-a910-3e38469dc9e4"], "metadata": {"file_path": "backend/auth.py", "function_name": "hash_password", "symbol_id": "backend.auth.hash_password", "type": "function", "start_line": 62, "end_line": 72}}, "d538911d-558c-4d48-b5ca-bf267a2c86f0": {"node_ids": ["4b91b304-541e-42fd-b52e-f28fdf72fe8f"], "metadata": {"file_path": "backend/auth.py", "function_name": "verify_password", "symbol_id": "backend.auth.verify_password", "type": "function", "start_line": 75, "end_line": 86}}, "b0c12d3a-e10d-40e7-83d8-aeddb62b1c0a": {"node_ids": ["46842e5c-b0fb-4a89-8ecb-5916e43e360f"], "metadata": {"file_path": "backend/db.py", "function_name": "get_dynamodb_client", "symbol_id": "backend.db.get_dynamodb_client", "type": "function", "start_line": 15, "end_line": 23}}, "2c077db2-f4f1-4995-8dee-3bfd91fac48c": {"node_ids": ["273089d2-a840-44a0-b980-82733e1f9699"], "metadata": {"file_path": "backend/db.py", "function_name": "get_dynamodb_resource", "symbol_id": "backend.db.get_dynamodb_resource", "type": "function", "start_line": 26, "end_line": 34}}, "97c80875-0fa0-43fc-97ac-c2b31eb0ca79": {"node_ids": ["330b9aa6-5ff8-49bf-a0ad-25939e0a28b9"], "metadata": {"file_path": "backend/db.py", "function_name": "get_table", "symbol_id": "backend.db.get_table", "type": "function", "start_line": 37, "end_line": 40}}, "b0800a97-f1b0-4589-ac7a-7facbd0abcdc": {"node_ids": ["253b5a6c-4dc0-40bb-be4c-77635ce1f111"], "metadata": {"file_path": "backend/db.py", "function_name": "close_connection", "symbol_id": "backend.db.close_connection", "type": "function", "start_line": 43, "end_line": 47}}, "68143e68-3de7-4e2a-b301-69cc2d865e17": {"node_ids": ["0f370229-563d-47ed-9b8a-117f250fffcd"], "metadata": {"file_path": "backend/init_dynamodb.py", "function_name": "get_dynamodb_resource", "symbol_id": "backend.init_dynamodb.get_dynamodb_resource", "type": "function", "start_line": 19, "end_line": 24}}, "a53d8556-45a8-4b52-88c2-f79fbe5b1c18": {"node_ids": ["5213e89a-23fb-464f-8d8a-17c35e5ffb28"], "metadata": {"file_path": "backend/init_dynamodb.py", "function_name": "init_dynamodb", "symbol_id": "backend.init_dynamodb.init_dynamodb", "type": "function", "start_line": 27, "end_line": 104}}, "14b7bf22-5c83-46b9-a79d-5144cde02583": {"node_ids": ["eed7eac8-7256-4842-8b81-474c0ed73e7e"], "metadata": {"file_path": "backend/init_dynamodb.py", "function_name": "main", "symbol_id": "backend.init_dynamodb.main", "type": "function", "start_line": 107, "end_line": 137}}, "2c4eb6f7-b7a7-4600-8ba8-2fb57fff9c53": {"node_ids": ["49901916-bfcd-4da9-8649-8a8bd28b7097"], "metadata": {"file_path": "backend/load_products.py", "function_name": "load_products_to_dynamodb", "symbol_id": "backend.load_products.load_products_to_dynamodb", "type": "function", "start_line": 13, "end_line": 52}}, "83e9b36c-4347-42e7-ad10-7100a6413811": {"node_ids": ["a36389c5-c4c7-46f0-a14c-5427b3e021b5"], "metadata": {"file_path": "backend/models.py", "function_name": "_python_obj_to_dynamodb", "symbol_id": "backend.models._python_obj_to_dynamodb", "type": "function", "start_line": 19, "end_line": 31}}, "35f228f7-8adb-4f50-b0e3-be7c1ac4f766": {"node_ids": ["e3e79a60-de2b-4296-8a0f-3aaba6f760e8"], "metadata": {"file_path": "backend/models.py", "function_name": "_dynamodb_to_python_obj", "symbol_id": "backend.models._dynamodb_to_python_obj", "type": "function", "start_line": 34, "end_line": 50}}, "864e20e7-b528-450a-b664-5ca9d7a023cd": {"node_ids": ["12de9655-afdb-49af-b9b2-702c9318eaaf"], "metadata": {"file_path": "backend/models.py", "function_name": "create_user", "symbol_id": "backend.models.create_user", "type": "function", "start_line": 55, "end_line": 93}}, "16bcc082-baab-4e9a-941b-0ab5565ba9f0": {"node_ids": ["f77f7f93-ca10-4c13-93bc-9ed41100ffd1"], "metadata": {"file_path": "backend/models.py", "function_name": "get_user_by_username", "symbol_id": "backend.models.get_user_by_username", "type": "function", "start_line": 96, "end_line": 121}}, "7d8c2056-a7b8-4921-98cb-976d32af1bf3": {"node_ids": ["f4db15e3-1f78-4321-97eb-3f77eb5cadf6"], "metadata": {"file_path": "backend/models.py", "function_name": "get_user_by_id", "symbol_id": "backend.models.get_user_by_id", "type": "function", "start_line": 124, "end_line": 148}}, "421ca100-6d2f-48c4-b32a-d9c2ad2aa3c7": {"node_ids": ["4f31569f-2c1d-4a4b-87a8-468cb7b3e9c8"], "metadata": {"file_path": "backend/models.py", "function_name": "get_cart_items", "symbol_id": "backend.models.get_cart_items", "type": "function", "start_line": 153, "end_line": 205}}, "5a43127c-ecbf-43fd-b4d3-365bd6c41f72": {"node_ids": ["eba260d9-17ac-44e2-8454-0a802055bc27"], "metadata": {"file_path": "backend/models.py", "function_name": "add_cart_item", "symbol_id": "backend.models.add_cart_item", "type": "function", "start_line": 208, "end_line": 249}}, "6da7c430-5a30-48b1-a86e-a2f72616e8f4": {"node_ids": ["bc25adfb-2067-40ab-9745-98c98f4f5709"], "metadata": {"file_path": "backend/models.py", "function_name": "update_cart_item_quantity", "symbol_id": "backend.models.update_cart_item_quantity", "type": "function", "start_line": 252, "end_line": 290}}, "7f9c2fe6-62f5-412e-81bf-69cac9a6cc10": {"node_ids": ["67f650ad-6702-4a49-933d-548459110d6c"], "metadata": {"file_path": "backend/models.py", "function_name": "delete_cart_items", "symbol_id": "backend.models.delete_cart_items", "type": "function", "start_line": 293, "end_line": 319}}, "f92a48ff-36ed-45e4-99e6-e81a7099df4b": {"node_ids": ["ecbdfc95-d678-44b2-85a7-729058938a8e"], "metadata": {"file_path": "backend/models.py", "function_name": "migrate_cart_items", "symbol_id": "backend.models.migrate_cart_items", "type": "function", "start_line": 322, "end_line": 405}}, "52c1491d-f736-4512-8345-02833a9dce21": {"node_ids": ["60471ab0-e28e-4ecc-a552-2b27433f01c7"], "metadata": {"file_path": "backend/models.py", "function_name": "get_product_total_quantity", "symbol_id": "backend.models.get_product_total_quantity", "type": "function", "start_line": 410, "end_line": 436}}, "1ccdfadd-b678-47ab-9f23-3580fb18509d": {"node_ids": ["5168c827-fd02-433b-8ce9-a89135567bfb"], "metadata": {"file_path": "backend/models.py", "function_name": "update_product_total_quantity", "symbol_id": "backend.models.update_product_total_quantity", "type": "function", "start_line": 439, "end_line": 488}}, "97275af1-e424-4951-8227-08dea6ced84d": {"node_ids": ["87bd9e78-18ba-484c-a152-f7c4155c1e71"], "metadata": {"file_path": "backend/models.py", "function_name": "cleanup_expired_items", "symbol_id": "backend.models.cleanup_expired_items", "type": "function", "start_line": 493, "end_line": 521}}, "14f02a56-7657-4499-8046-2c2664bcc6b1": {"node_ids": ["343d7ca2-d5fc-43fc-b968-32b6b8af11cb"], "metadata": {}}, "5cf83985-6982-4b86-9037-6ff48460dcf0": {"node_ids": ["89a02f03-33fa-4ffd-aebd-341c00973994"], "metadata": {}}, "39df17a6-3479-4878-ab69-d966a7954d1d": {"node_ids": ["8583bc50-f980-4145-bbfe-37b65cb0f93d"], "metadata": {}}, "56fabde6-6c71-4da5-aa03-d5c9bbde0fb2": {"node_ids": ["69da2980-2203-438a-86b1-6279e151b499"], "metadata": {}}, "891d0708-3cde-46b0-a8b6-0219e474cd92": {"node_ids": ["31d7768f-47fd-4752-986a-98426498c1bf"], "metadata": {}}}, "docstore/data": {"6d6f9394-ad72-42b9-baea-92ffad7651ed": {"__data__": {"id_": "6d6f9394-ad72-42b9-baea-92ffad7651ed", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "get_cart_id_from_cookie", "symbol_id": "backend.app.get_cart_id_from_cookie", "type": "function", "start_line": 52, "end_line": 59}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "1768ec30-2fe6-41c6-8941-0b1476bde852", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "get_cart_id_from_cookie", "symbol_id": "backend.app.get_cart_id_from_cookie", "type": "function", "start_line": 52, "end_line": 59}, "hash": "3193ed17a88f96b59ba0b1ffc2cd11b87abe35d19a2d2a71aba36eb73960f042", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_cart_id_from_cookie():\n    \"\"\"\u4eceCookie\u4e2d\u83b7\u53d6\u8d2d\u7269\u8f66ID\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u751f\u6210\u65b0\u7684\"\"\"\n    cart_id = request.cookies.get('cartId')\n    generated = False\n    if not cart_id:\n        cart_id = str(uuid4())\n        generated = True\n    return cart_id, generated", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 239, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "e349abb4-5cd2-4cbf-9bc3-4ed8e2a8a15a": {"__data__": {"id_": "e349abb4-5cd2-4cbf-9bc3-4ed8e2a8a15a", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "set_cart_cookie", "symbol_id": "backend.app.set_cart_cookie", "type": "function", "start_line": 62, "end_line": 73}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5c230dea-11c4-4eb6-9763-f290412b99e1", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "set_cart_cookie", "symbol_id": "backend.app.set_cart_cookie", "type": "function", "start_line": 62, "end_line": 73}, "hash": "6c220ab943b95036f84468bf0e66caefaa04df76da565e29e886e63ce0c5cfb3", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def set_cart_cookie(response, cart_id):\n    \"\"\"\u8bbe\u7f6e\u8d2d\u7269\u8f66Cookie\"\"\"\n    response.set_cookie(\n        'cartId',\n        cart_id,\n        max_age=60 * 60 * 24,  # 1\u5929\n        secure=False,  # \u5f00\u53d1\u73af\u5883\u8bbe\u4e3aFalse\uff0c\u751f\u4ea7\u73af\u5883\u5e94\u4e3aTrue\n        httponly=True,\n        samesite='Lax',\n        path='/'\n    )\n    return response", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 295, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "5937904d-77ea-41cd-bb18-e5eeecf8d1f1": {"__data__": {"id_": "5937904d-77ea-41cd-bb18-e5eeecf8d1f1", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "login_required", "symbol_id": "backend.app.login_required", "type": "function", "start_line": 76, "end_line": 95}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "28145676-f521-4f08-bae5-ca75328fb6bc", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "login_required", "symbol_id": "backend.app.login_required", "type": "function", "start_line": 76, "end_line": 95}, "hash": "ba5709018df355be3a944c977227db63280f890c56e27b1502f2422f17bb2da8", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def login_required(f):\n    \"\"\"\u8ba4\u8bc1\u88c5\u9970\u5668 - \u8981\u6c42\u7528\u6237\u767b\u5f55\"\"\"\n    @wraps(f)\n    def decorated_function(*args, **kwargs):\n        auth_header = request.headers.get('Authorization')\n        if not auth_header:\n            return jsonify({'message': 'Missing authorization header'}), 401\n        \n        try:\n            # \u652f\u6301 \"Bearer token\" \u6216\u76f4\u63a5 \"token\" \u683c\u5f0f\n            token = auth_header.replace('Bearer ', '')\n            payload = verify_token(token)\n            request.user_id = payload['sub']\n            request.username = payload['username']\n        except Exception as e:\n            return jsonify({'message': 'Invalid or expired token'}), 401\n        \n        return f(*args, **kwargs)\n    \n    return decorated_function", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 714, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "e4a58967-cb53-44a2-8174-ebc2cc5936cd": {"__data__": {"id_": "e4a58967-cb53-44a2-8174-ebc2cc5936cd", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "decorated_function", "symbol_id": "backend.app.decorated_function", "type": "function", "start_line": 79, "end_line": 93}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f184d9c8-7261-4567-b8a3-59f11fee99b0", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "decorated_function", "symbol_id": "backend.app.decorated_function", "type": "function", "start_line": 79, "end_line": 93}, "hash": "d9656bf486233c9ee082d34016380ce9b1e4cc56a14f33dd32d32440875357d6", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def decorated_function(*args, **kwargs):\n        auth_header = request.headers.get('Authorization')\n        if not auth_header:\n            return jsonify({'message': 'Missing authorization header'}), 401\n        \n        try:\n            # \u652f\u6301 \"Bearer token\" \u6216\u76f4\u63a5 \"token\" \u683c\u5f0f\n            token = auth_header.replace('Bearer ', '')\n            payload = verify_token(token)\n            request.user_id = payload['sub']\n            request.username = payload['username']\n        except Exception as e:\n            return jsonify({'message': 'Invalid or expired token'}), 401\n        \n        return f(*args, **kwargs)", "mimetype": "text/plain", "start_char_idx": 4, "end_char_idx": 617, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "db95a299-e067-404d-a1a3-f782c870fadf": {"__data__": {"id_": "db95a299-e067-404d-a1a3-f782c870fadf", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "get_user_identifier", "symbol_id": "backend.app.get_user_identifier", "type": "function", "start_line": 98, "end_line": 110}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d8cdbe46-415d-44f5-a7bd-70709f02c911", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "get_user_identifier", "symbol_id": "backend.app.get_user_identifier", "type": "function", "start_line": 98, "end_line": 110}, "hash": "939f49fabb02e9693456b1b08a035dbe7ce1511163f2a88fa4dc519e7ddfaac2", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_user_identifier():\n    \"\"\"\u83b7\u53d6\u7528\u6237\u6807\u8bc6\uff08\u5df2\u767b\u5f55\u7528\u6237\u7684user_id\u6216\u533f\u540d\u7528\u6237\u7684cart_id\uff09\"\"\"\n    auth_header = request.headers.get('Authorization')\n    if auth_header:\n        try:\n            token = auth_header.replace('Bearer ', '')\n            payload = verify_token(token)\n            return f\"user#{payload['sub']}\", True\n        except:\n            pass\n    \n    cart_id, _ = get_cart_id_from_cookie()\n    return f\"cart#{cart_id}\", False", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 423, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "a2f440fd-c262-4058-a745-490fbd2023eb": {"__data__": {"id_": "a2f440fd-c262-4058-a745-490fbd2023eb", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "register", "symbol_id": "backend.app.register", "type": "function", "start_line": 116, "end_line": 136}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "936cb1b1-76b8-4b16-bfc0-e519ba7147bd", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "register", "symbol_id": "backend.app.register", "type": "function", "start_line": 116, "end_line": 136}, "hash": "d5ee178c6f667b72788e9031653777c5545d25f1f6bc8bc55aeb747df682fcc9", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def register():\n    \"\"\"\u7528\u6237\u6ce8\u518c\"\"\"\n    data = request.get_json()\n    username = data.get('username')\n    password = data.get('password')\n    email = data.get('email')\n    \n    if not username or not password:\n        return jsonify({'message': 'Username and password required'}), 400\n    \n    # \u68c0\u67e5\u7528\u6237\u662f\u5426\u5df2\u5b58\u5728\n    if get_user_by_username(username):\n        return jsonify({'message': 'Username already exists'}), 400\n    \n    # \u521b\u5efa\u7528\u6237\n    user_id = create_user(username, password, email)\n    \n    return jsonify({\n        'message': 'User registered successfully',\n        'userId': user_id\n    }), 201", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 591, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "42cfaa63-10e4-4d6c-833a-7e56d5bf7551": {"__data__": {"id_": "42cfaa63-10e4-4d6c-833a-7e56d5bf7551", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "login", "symbol_id": "backend.app.login", "type": "function", "start_line": 140, "end_line": 162}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "2645ebb7-6990-4655-b7b5-30be699c1e53", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "login", "symbol_id": "backend.app.login", "type": "function", "start_line": 140, "end_line": 162}, "hash": "4258304d748cb5250cced15132ade0726c5a37b60c8288d1799614af4431295d", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def login():\n    \"\"\"\u7528\u6237\u767b\u5f55\"\"\"\n    data = request.get_json()\n    username = data.get('username')\n    password = data.get('password')\n    \n    if not username or not password:\n        return jsonify({'message': 'Username and password required'}), 400\n    \n    # \u9a8c\u8bc1\u7528\u6237\n    user = get_user_by_username(username)\n    if not user or not verify_password(password, user['password_hash']):\n        return jsonify({'message': 'Invalid credentials'}), 401\n    \n    # \u751f\u6210JWT token\n    token = create_token(user['id'], username)\n    \n    return jsonify({\n        'message': 'Login successful',\n        'token': token,\n        'userId': user['id'],\n        'username': username\n    }), 200", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 671, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "5d56eeab-ee74-4b53-9696-306e32e001ff": {"__data__": {"id_": "5d56eeab-ee74-4b53-9696-306e32e001ff", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "get_products", "symbol_id": "backend.app.get_products", "type": "function", "start_line": 168, "end_line": 170}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "3f568699-6bdd-47d4-87ff-c4288b7f3c3d", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "get_products", "symbol_id": "backend.app.get_products", "type": "function", "start_line": 168, "end_line": 170}, "hash": "8212c5d323957de791c90dbff1298c5192db6aecb0f6639446c9e7b232dc7808", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_products():\n    \"\"\"\u83b7\u53d6\u6240\u6709\u4ea7\u54c1\u5217\u8868\"\"\"\n    return jsonify({'products': PRODUCT_LIST}), 200", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 90, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "1c2e63a5-87c5-4cf4-b876-f1789b638b2c": {"__data__": {"id_": "1c2e63a5-87c5-4cf4-b876-f1789b638b2c", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "get_product", "symbol_id": "backend.app.get_product", "type": "function", "start_line": 174, "end_line": 181}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "60ebec05-5949-4f21-a54f-9fe65b70804c", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "get_product", "symbol_id": "backend.app.get_product", "type": "function", "start_line": 174, "end_line": 181}, "hash": "73a75cd2115df03899865d71d6840d35990eb8570b2f06b63c7bbff6c2b7d6dd", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_product(product_id):\n    \"\"\"\u83b7\u53d6\u5355\u4e2a\u4ea7\u54c1\u8be6\u60c5\"\"\"\n    product = next((p for p in PRODUCT_LIST if p['productId'] == product_id), None)\n    \n    if not product:\n        return jsonify({'message': 'Product not found'}), 404\n    \n    return jsonify({'product': product}), 200", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 269, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "64594dc3-1330-4501-9617-8e9b6b27f2ba": {"__data__": {"id_": "64594dc3-1330-4501-9617-8e9b6b27f2ba", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "list_cart", "symbol_id": "backend.app.list_cart", "type": "function", "start_line": 187, "end_line": 205}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fff8de69-ce5f-400d-870d-81927a768a3d", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "list_cart", "symbol_id": "backend.app.list_cart", "type": "function", "start_line": 187, "end_line": 205}, "hash": "22e1cab6cf4521f79dd16596e6f119a7af00b2db5a3be815b8e7e60f9fe93bc8", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def list_cart():\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u7528\u6237\u7684\u8d2d\u7269\u8f66\u5185\u5bb9\"\"\"\n    cart_id, generated = get_cart_id_from_cookie()\n    pk, is_authenticated = get_user_identifier()\n    \n    # \u5982\u679c\u662f\u65b0\u751f\u6210\u7684cart_id\uff0c\u4e0d\u9700\u8981\u67e5\u8be2\u6570\u636e\u5e93\n    if generated and not is_authenticated:\n        product_list = []\n    else:\n        product_list = get_cart_items(pk)\n    \n    # \u6e05\u7406\u8fd4\u56de\u6570\u636e\u683c\u5f0f\n    for product in product_list:\n        if 'sk' in product:\n            product['sk'] = product['sk'].replace('product#', '')\n    \n    response = make_response(jsonify({'products': product_list}))\n    response = set_cart_cookie(response, cart_id)\n    return response, 200", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 588, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "9aab8f03-4f67-48b4-bc82-28656fb015be": {"__data__": {"id_": "9aab8f03-4f67-48b4-bc82-28656fb015be", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "add_to_cart", "symbol_id": "backend.app.add_to_cart", "type": "function", "start_line": 209, "end_line": 248}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc8aa823-7830-4165-a18f-58b5b43c514c", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "add_to_cart", "symbol_id": "backend.app.add_to_cart", "type": "function", "start_line": 209, "end_line": 248}, "hash": "9dbe4ffc91b5bfd1f5bf0402d3fb747e5e5060f81a771fd3d608e805835b93c0", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def add_to_cart():\n    \"\"\"\u6dfb\u52a0\u5546\u54c1\u5230\u8d2d\u7269\u8f66\"\"\"\n    data = request.get_json()\n    if not data:\n        return jsonify({'message': 'No request payload'}), 400\n    \n    product_id = data.get('productId')\n    quantity = data.get('quantity', 1)\n    \n    if not product_id:\n        return jsonify({'message': 'Product ID required'}), 400\n    \n    # \u9a8c\u8bc1\u4ea7\u54c1\u662f\u5426\u5b58\u5728\n    product = next((p for p in PRODUCT_LIST if p['productId'] == product_id), None)\n    if not product:\n        return jsonify({'message': 'Product not found'}), 404\n    \n    cart_id, _ = get_cart_id_from_cookie()\n    pk, is_authenticated = get_user_identifier()\n    \n    # \u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\n    if is_authenticated:\n        ttl = datetime.now() + timedelta(days=7)\n    else:\n        ttl = datetime.now() + timedelta(days=1)\n    \n    # \u6dfb\u52a0\u6216\u66f4\u65b0\u8d2d\u7269\u8f66\u9879\n    try:\n        add_cart_item(pk, product_id, quantity, product, ttl)\n        # \u540c\u6b65\u66f4\u65b0\u5546\u54c1\u7edf\u8ba1\n        update_product_total_quantity(product_id, quantity)\n    except Exception as e:\n        return jsonify({'message': f'Failed to add to cart: {str(e)}'}), 500\n    \n    response = make_response(jsonify({\n        'productId': product_id,\n        'message': 'product added to cart'\n    }))\n    response = set_cart_cookie(response, cart_id)\n    return response, 200", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1234, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "28a4e7f6-ed37-448f-9aeb-5f9870d4a08b": {"__data__": {"id_": "28a4e7f6-ed37-448f-9aeb-5f9870d4a08b", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "update_cart", "symbol_id": "backend.app.update_cart", "type": "function", "start_line": 252, "end_line": 305}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "0c4272ce-252e-4006-9465-4989f4ab736b", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "update_cart", "symbol_id": "backend.app.update_cart", "type": "function", "start_line": 252, "end_line": 305}, "hash": "f6b836d9cfe5e2988f60494d28f676d5269035b6c1a6112326443b241ed2f8e9", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def update_cart(product_id):\n    \"\"\"\u66f4\u65b0\u8d2d\u7269\u8f66\u4e2d\u6307\u5b9a\u5546\u54c1\u7684\u6570\u91cf\uff08\u5e42\u7b49\u64cd\u4f5c\uff09\"\"\"\n    data = request.get_json()\n    if not data:\n        return jsonify({'message': 'No request payload'}), 400\n    \n    quantity = int(data.get('quantity', 0))\n    \n    if quantity < 0:\n        return jsonify({\n            'productId': product_id,\n            'message': 'Quantity must not be lower than 0'\n        }), 400\n    \n    # \u9a8c\u8bc1\u4ea7\u54c1\u662f\u5426\u5b58\u5728\n    product = next((p for p in PRODUCT_LIST if p['productId'] == product_id), None)\n    if not product:\n        return jsonify({'message': 'Product not found'}), 404\n    \n    cart_id, _ = get_cart_id_from_cookie()\n    pk, is_authenticated = get_user_identifier()\n    \n    # \u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\n    if is_authenticated:\n        ttl = datetime.now() + timedelta(days=7)\n    else:\n        ttl = datetime.now() + timedelta(days=1)\n    \n    try:\n        # \u83b7\u53d6\u65e7\u7684\u6570\u91cf\u4ee5\u8ba1\u7b97\u5dee\u503c\n        old_quantity = 0\n        items = get_cart_items(pk)\n        for item in items:\n            if item['sk'] == f\"product#{product_id}\":\n                old_quantity = item['quantity']\n                break\n        \n        # \u66f4\u65b0\u8d2d\u7269\u8f66\u9879\n        update_cart_item_quantity(pk, product_id, quantity, product, ttl)\n        \n        # \u540c\u6b65\u66f4\u65b0\u5546\u54c1\u7edf\u8ba1\uff08\u5dee\u503c\uff09\n        quantity_diff = quantity - old_quantity\n        if quantity_diff != 0:\n            update_product_total_quantity(product_id, quantity_diff)\n    except Exception as e:\n        return jsonify({'message': f'Failed to update cart: {str(e)}'}), 500\n    \n    response = make_response(jsonify({\n        'productId': product_id,\n        'quantity': quantity,\n        'message': 'cart updated'\n    }))\n    response = set_cart_cookie(response, cart_id)\n    return response, 200", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1669, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "7e4d33a7-1858-4cc2-81b1-09189f1f3e24": {"__data__": {"id_": "7e4d33a7-1858-4cc2-81b1-09189f1f3e24", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "migrate_cart", "symbol_id": "backend.app.migrate_cart", "type": "function", "start_line": 310, "end_line": 334}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e1a9abd9-8735-4709-a8f7-304b117a3b24", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "migrate_cart", "symbol_id": "backend.app.migrate_cart", "type": "function", "start_line": 310, "end_line": 334}, "hash": "e231a3d19fe68123443b444396c48b2e1ed4fe04cbc1ec0d88b390af3807462e", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def migrate_cart():\n    \"\"\"\u5c06\u533f\u540d\u8d2d\u7269\u8f66\u8fc1\u79fb\u5230\u5df2\u767b\u5f55\u7528\u6237\u8d26\u6237\"\"\"\n    cart_id, _ = get_cart_id_from_cookie()\n    user_id = request.user_id\n    \n    anonymous_pk = f\"cart#{cart_id}\"\n    user_pk = f\"user#{user_id}\"\n    \n    try:\n        # \u8fc1\u79fb\u8d2d\u7269\u8f66\u9879\n        migrated_items = migrate_cart_items(anonymous_pk, user_pk)\n    except Exception as e:\n        return jsonify({'message': f'Failed to migrate cart: {str(e)}'}), 500\n    \n    # \u83b7\u53d6\u8fc1\u79fb\u540e\u7684\u8d2d\u7269\u8f66\n    product_list = get_cart_items(user_pk)\n    \n    # \u6e05\u7406\u8fd4\u56de\u6570\u636e\u683c\u5f0f\n    for product in product_list:\n        if 'sk' in product:\n            product['sk'] = product['sk'].replace('product#', '')\n    \n    response = make_response(jsonify({'products': product_list}))\n    response = set_cart_cookie(response, cart_id)\n    return response, 200", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 753, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "f388308b-a2a4-41bc-87da-9e80127eb15a": {"__data__": {"id_": "f388308b-a2a4-41bc-87da-9e80127eb15a", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "checkout_cart", "symbol_id": "backend.app.checkout_cart", "type": "function", "start_line": 339, "end_line": 365}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "923a6b62-55f2-40a1-9675-8bd7aff11ad5", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "checkout_cart", "symbol_id": "backend.app.checkout_cart", "type": "function", "start_line": 339, "end_line": 365}, "hash": "3866b6e54dcc6c6982765058726c08bae34192bebd52854b48f0562cb3f4cd7d", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def checkout_cart():\n    \"\"\"\u7ed3\u7b97\u8d2d\u7269\u8f66\uff08\u6e05\u7a7a\u8d2d\u7269\u8f66\uff09\"\"\"\n    cart_id, _ = get_cart_id_from_cookie()\n    user_id = request.user_id\n    user_pk = f\"user#{user_id}\"\n    \n    # \u83b7\u53d6\u8d2d\u7269\u8f66\u9879\n    cart_items = get_cart_items(user_pk)\n    \n    try:\n        # \u6e05\u7a7a\u8d2d\u7269\u8f66\u524d\uff0c\u9700\u8981\u66f4\u65b0\u5546\u54c1\u7edf\u8ba1\uff08\u51cf\u5c11\u6570\u91cf\uff09\n        for item in cart_items:\n            product_id = item['sk'].replace('product#', '')\n            quantity = -item['quantity']  # \u8d1f\u6570\u8868\u793a\u51cf\u5c11\n            update_product_total_quantity(product_id, quantity)\n        \n        # \u5220\u9664\u8d2d\u7269\u8f66\u9879\n        delete_cart_items(user_pk)\n    except Exception as e:\n        return jsonify({'message': f'Failed to checkout: {str(e)}'}), 500\n    \n    response = make_response(jsonify({\n        'products': cart_items,\n        'message': 'Checkout successful'\n    }))\n    response = set_cart_cookie(response, cart_id)\n    return response, 200", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 822, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "c97ea4df-f9f2-44d9-9891-9be4a4065da9": {"__data__": {"id_": "c97ea4df-f9f2-44d9-9891-9be4a4065da9", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "get_cart_total", "symbol_id": "backend.app.get_cart_total", "type": "function", "start_line": 369, "end_line": 379}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "268be702-dfb4-4ac1-8b64-7699798f068e", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "get_cart_total", "symbol_id": "backend.app.get_cart_total", "type": "function", "start_line": 369, "end_line": 379}, "hash": "66e188c7ae6278aca990d848ce42063556cd2c78a20910da084c802b07ab0404", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_cart_total(product_id):\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u5546\u54c1\u5728\u6240\u6709\u8d2d\u7269\u8f66\u4e2d\u7684\u603b\u6570\u91cf\"\"\"\n    try:\n        total = get_product_total_quantity(product_id)\n    except Exception as e:\n        return jsonify({'message': f'Failed to get total: {str(e)}'}), 500\n    \n    return jsonify({\n        'product': product_id,\n        'quantity': total\n    }), 200", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 320, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "a6e22085-676e-48d6-8025-8f9b75661a04": {"__data__": {"id_": "a6e22085-676e-48d6-8025-8f9b75661a04", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "serve_frontend", "symbol_id": "backend.app.serve_frontend", "type": "function", "start_line": 386, "end_line": 406}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6ab3e1e4-f796-44b9-9836-f84b677b3ce9", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "serve_frontend", "symbol_id": "backend.app.serve_frontend", "type": "function", "start_line": 386, "end_line": 406}, "hash": "4a94766901816ff561fe5b6ab8b93b1c72b2e809b078b816473d0681b907a4a0", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def serve_frontend(path):\n    \"\"\"\n    \u670d\u52a1\u524d\u7aef\u9759\u6001\u6587\u4ef6\n    \u6240\u6709\u975eAPI\u8def\u7531\u90fd\u8fd4\u56deindex.html\uff0c\u7531\u524d\u7aefVue Router\u5904\u7406\n    \"\"\"\n    # API\u8def\u7531\u4e0d\u5e94\u8be5\u88ab\u8fd9\u91cc\u5904\u7406\n    if path.startswith('auth/') or path.startswith('cart') or path.startswith('product'):\n        return jsonify({'message': 'API endpoint not found'}), 404\n    \n    # \u5982\u679c\u8bf7\u6c42\u7684\u662f\u9759\u6001\u8d44\u6e90\u6587\u4ef6\uff08\u6709\u6269\u5c55\u540d\uff09\uff0c\u5c1d\u8bd5\u8fd4\u56de\u8be5\u6587\u4ef6\n    if path and '.' in path:\n        try:\n            return send_from_directory(app.static_folder, path)\n        except:\n            pass\n    \n    # \u5426\u5219\u8fd4\u56deindex.html\uff0c\u8ba9\u524d\u7aef\u8def\u7531\u5904\u7406\n    try:\n        return send_from_directory(app.static_folder, 'index.html')\n    except:\n        return jsonify({'message': 'Frontend not built. Please run: cd frontend && npm install && npm run build'}), 404", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 693, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "d52e7449-0fab-4d87-9265-084f4f4846c1": {"__data__": {"id_": "d52e7449-0fab-4d87-9265-084f4f4846c1", "embedding": null, "metadata": {"file_path": "backend/app.py", "function_name": "internal_error", "symbol_id": "backend.app.internal_error", "type": "function", "start_line": 412, "end_line": 414}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b0ad6760-6d57-4923-ba79-6f313f6280fb", "node_type": "4", "metadata": {"file_path": "backend/app.py", "function_name": "internal_error", "symbol_id": "backend.app.internal_error", "type": "function", "start_line": 412, "end_line": 414}, "hash": "ec3978eab1ea09130f9b8299e153564c2831f578929bf1dd5fbd7a7445ea5fc8", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def internal_error(error):\n    \"\"\"500\u9519\u8bef\u5904\u7406\"\"\"\n    return jsonify({'message': 'Internal server error'}), 500", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 106, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "1bcbf916-657d-46e2-8d2a-91d5e1725025": {"__data__": {"id_": "1bcbf916-657d-46e2-8d2a-91d5e1725025", "embedding": null, "metadata": {"file_path": "backend/auth.py", "function_name": "create_token", "symbol_id": "backend.auth.create_token", "type": "function", "start_line": 17, "end_line": 36}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "34003c8e-ac99-4ad8-9764-63eb13ad7928", "node_type": "4", "metadata": {"file_path": "backend/auth.py", "function_name": "create_token", "symbol_id": "backend.auth.create_token", "type": "function", "start_line": 17, "end_line": 36}, "hash": "2f43364ba9c55e72bed5c01d09d596950f2799ee6d5f49d2816c47275a2af21e", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def create_token(user_id, username):\n    \"\"\"\n    \u521b\u5efaJWT token\n    \n    Args:\n        user_id: \u7528\u6237ID\n        username: \u7528\u6237\u540d\n    \n    Returns:\n        JWT token\u5b57\u7b26\u4e32\n    \"\"\"\n    payload = {\n        'sub': user_id,\n        'username': username,\n        'exp': datetime.utcnow() + timedelta(hours=TOKEN_EXPIRATION_HOURS),\n        'iat': datetime.utcnow()\n    }\n    \n    token = jwt.encode(payload, SECRET_KEY, algorithm=ALGORITHM)\n    return token", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 438, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "6e3f2c44-c60c-4121-96ed-abd553b73a85": {"__data__": {"id_": "6e3f2c44-c60c-4121-96ed-abd553b73a85", "embedding": null, "metadata": {"file_path": "backend/auth.py", "function_name": "verify_token", "symbol_id": "backend.auth.verify_token", "type": "function", "start_line": 39, "end_line": 59}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "3379f98f-8bfd-44ed-9c20-7c62640922ff", "node_type": "4", "metadata": {"file_path": "backend/auth.py", "function_name": "verify_token", "symbol_id": "backend.auth.verify_token", "type": "function", "start_line": 39, "end_line": 59}, "hash": "4265bb2929e107c6f172a533efc21876abc71ba83d1f6d1f1e212d3bd7a23b39", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def verify_token(token):\n    \"\"\"\n    \u9a8c\u8bc1JWT token\n    \n    Args:\n        token: JWT token\u5b57\u7b26\u4e32\n    \n    Returns:\n        \u89e3\u7801\u540e\u7684payload\u5b57\u5178\n    \n    Raises:\n        jwt.ExpiredSignatureError: token\u5df2\u8fc7\u671f\n        jwt.InvalidTokenError: token\u65e0\u6548\n    \"\"\"\n    try:\n        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])\n        return payload\n    except jwt.ExpiredSignatureError:\n        raise Exception('Token has expired')\n    except jwt.InvalidTokenError:\n        raise Exception('Invalid token')", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 501, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "bd7cd9f1-b9a4-4646-a910-3e38469dc9e4": {"__data__": {"id_": "bd7cd9f1-b9a4-4646-a910-3e38469dc9e4", "embedding": null, "metadata": {"file_path": "backend/auth.py", "function_name": "hash_password", "symbol_id": "backend.auth.hash_password", "type": "function", "start_line": 62, "end_line": 72}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "0116dbf0-3f46-48a5-93ae-afe91aa9b9d4", "node_type": "4", "metadata": {"file_path": "backend/auth.py", "function_name": "hash_password", "symbol_id": "backend.auth.hash_password", "type": "function", "start_line": 62, "end_line": 72}, "hash": "40204a5361a7291831994aea6eb2bdfc4a338797c777e6f75412790c5eb55b17", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def hash_password(password):\n    \"\"\"\n    \u52a0\u5bc6\u5bc6\u7801\n    \n    Args:\n        password: \u660e\u6587\u5bc6\u7801\n    \n    Returns:\n        \u52a0\u5bc6\u540e\u7684\u5bc6\u7801\u54c8\u5e0c\n    \"\"\"\n    return generate_password_hash(password, method='pbkdf2:sha256')", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 194, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "4b91b304-541e-42fd-b52e-f28fdf72fe8f": {"__data__": {"id_": "4b91b304-541e-42fd-b52e-f28fdf72fe8f", "embedding": null, "metadata": {"file_path": "backend/auth.py", "function_name": "verify_password", "symbol_id": "backend.auth.verify_password", "type": "function", "start_line": 75, "end_line": 86}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d538911d-558c-4d48-b5ca-bf267a2c86f0", "node_type": "4", "metadata": {"file_path": "backend/auth.py", "function_name": "verify_password", "symbol_id": "backend.auth.verify_password", "type": "function", "start_line": 75, "end_line": 86}, "hash": "8884357837cc5866fd57fc27278d16c594a2f08dc69e03e4b92f18782a041d64", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def verify_password(password, password_hash):\n    \"\"\"\n    \u9a8c\u8bc1\u5bc6\u7801\n    \n    Args:\n        password: \u660e\u6587\u5bc6\u7801\n        password_hash: \u5bc6\u7801\u54c8\u5e0c\n    \n    Returns:\n        \u5e03\u5c14\u503c\uff0c\u8868\u793a\u5bc6\u7801\u662f\u5426\u5339\u914d\n    \"\"\"\n    return check_password_hash(password_hash, password)", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 231, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "46842e5c-b0fb-4a89-8ecb-5916e43e360f": {"__data__": {"id_": "46842e5c-b0fb-4a89-8ecb-5916e43e360f", "embedding": null, "metadata": {"file_path": "backend/db.py", "function_name": "get_dynamodb_client", "symbol_id": "backend.db.get_dynamodb_client", "type": "function", "start_line": 15, "end_line": 23}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b0c12d3a-e10d-40e7-83d8-aeddb62b1c0a", "node_type": "4", "metadata": {"file_path": "backend/db.py", "function_name": "get_dynamodb_client", "symbol_id": "backend.db.get_dynamodb_client", "type": "function", "start_line": 15, "end_line": 23}, "hash": "daa2a22f380742be595ae9c5deac211106c13c5e72d37091e3ebc345df8fd5a6", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_dynamodb_client():\n    \"\"\"\u83b7\u53d6DynamoDB\u5ba2\u6237\u7aef\uff08\u4f4e\u7ea7API\uff09\"\"\"\n    client = getattr(g, '_dynamodb_client', None)\n    if client is None:\n        client = g._dynamodb_client = boto3.client(\n            'dynamodb',\n            region_name=AWS_REGION\n        )\n    return client", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 269, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "273089d2-a840-44a0-b980-82733e1f9699": {"__data__": {"id_": "273089d2-a840-44a0-b980-82733e1f9699", "embedding": null, "metadata": {"file_path": "backend/db.py", "function_name": "get_dynamodb_resource", "symbol_id": "backend.db.get_dynamodb_resource", "type": "function", "start_line": 26, "end_line": 34}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "2c077db2-f4f1-4995-8dee-3bfd91fac48c", "node_type": "4", "metadata": {"file_path": "backend/db.py", "function_name": "get_dynamodb_resource", "symbol_id": "backend.db.get_dynamodb_resource", "type": "function", "start_line": 26, "end_line": 34}, "hash": "478dcc4bbb04bd59ffa89ffd2545f20a6221d973de0c948f0b18853d5e443dae", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_dynamodb_resource():\n    \"\"\"\u83b7\u53d6DynamoDB\u8d44\u6e90\u5bf9\u8c61\uff08\u9ad8\u7ea7API\uff09\"\"\"\n    resource = getattr(g, '_dynamodb_resource', None)\n    if resource is None:\n        resource = g._dynamodb_resource = boto3.resource(\n            'dynamodb',\n            region_name=AWS_REGION\n        )\n    return resource", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 286, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "330b9aa6-5ff8-49bf-a0ad-25939e0a28b9": {"__data__": {"id_": "330b9aa6-5ff8-49bf-a0ad-25939e0a28b9", "embedding": null, "metadata": {"file_path": "backend/db.py", "function_name": "get_table", "symbol_id": "backend.db.get_table", "type": "function", "start_line": 37, "end_line": 40}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "97c80875-0fa0-43fc-97ac-c2b31eb0ca79", "node_type": "4", "metadata": {"file_path": "backend/db.py", "function_name": "get_table", "symbol_id": "backend.db.get_table", "type": "function", "start_line": 37, "end_line": 40}, "hash": "01d9134e28f34dea06943e104bafc46efe133cab5e4500f6f95f9c1ff5c7022d", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_table():\n    \"\"\"\u83b7\u53d6\u8d2d\u7269\u8f66\u4e3b\u8868\"\"\"\n    dynamodb = get_dynamodb_resource()\n    return dynamodb.Table(TABLE_NAME)", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 111, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "253b5a6c-4dc0-40bb-be4c-77635ce1f111": {"__data__": {"id_": "253b5a6c-4dc0-40bb-be4c-77635ce1f111", "embedding": null, "metadata": {"file_path": "backend/db.py", "function_name": "close_connection", "symbol_id": "backend.db.close_connection", "type": "function", "start_line": 43, "end_line": 47}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b0800a97-f1b0-4589-ac7a-7facbd0abcdc", "node_type": "4", "metadata": {"file_path": "backend/db.py", "function_name": "close_connection", "symbol_id": "backend.db.close_connection", "type": "function", "start_line": 43, "end_line": 47}, "hash": "a0443b65ccfb71f775d67bd08cc1c6c168863833a1fd075db6ea23e8ec0c19e1", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def close_connection(exception):\n    \"\"\"\u6e05\u7406\u8fde\u63a5\uff08DynamoDB SDK\u4f1a\u81ea\u52a8\u7ba1\u7406\u8fde\u63a5\u6c60\uff0c\u6b64\u51fd\u6570\u4fdd\u7559\u7528\u4e8e\u517c\u5bb9\u6027\uff09\"\"\"\n    # \u79fb\u9664\u7f13\u5b58\u7684\u5ba2\u6237\u7aef\u548c\u8d44\u6e90\u5bf9\u8c61\n    g.pop('_dynamodb_client', None)\n    g.pop('_dynamodb_resource', None)", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 174, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "0f370229-563d-47ed-9b8a-117f250fffcd": {"__data__": {"id_": "0f370229-563d-47ed-9b8a-117f250fffcd", "embedding": null, "metadata": {"file_path": "backend/init_dynamodb.py", "function_name": "get_dynamodb_resource", "symbol_id": "backend.init_dynamodb.get_dynamodb_resource", "type": "function", "start_line": 19, "end_line": 24}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "68143e68-3de7-4e2a-b301-69cc2d865e17", "node_type": "4", "metadata": {"file_path": "backend/init_dynamodb.py", "function_name": "get_dynamodb_resource", "symbol_id": "backend.init_dynamodb.get_dynamodb_resource", "type": "function", "start_line": 19, "end_line": 24}, "hash": "b18d80cf20c6be7d07d7c5d6c446a05d0acf235dd5fe9508e4107880d2c3d41c", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_dynamodb_resource():\n    \"\"\"\u83b7\u53d6DynamoDB\u8d44\u6e90\u5bf9\u8c61\"\"\"\n    return boto3.resource(\n        'dynamodb',\n        region_name=AWS_REGION\n    )", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 137, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "5213e89a-23fb-464f-8d8a-17c35e5ffb28": {"__data__": {"id_": "5213e89a-23fb-464f-8d8a-17c35e5ffb28", "embedding": null, "metadata": {"file_path": "backend/init_dynamodb.py", "function_name": "init_dynamodb", "symbol_id": "backend.init_dynamodb.init_dynamodb", "type": "function", "start_line": 27, "end_line": 104}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a53d8556-45a8-4b52-88c2-f79fbe5b1c18", "node_type": "4", "metadata": {"file_path": "backend/init_dynamodb.py", "function_name": "init_dynamodb", "symbol_id": "backend.init_dynamodb.init_dynamodb", "type": "function", "start_line": 27, "end_line": 104}, "hash": "03553a358a4df863b28bf6f693083deb649e3926f16229385d5164b5205adc75", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def init_dynamodb():\n    \"\"\"\n    \u521d\u59cb\u5316DynamoDB\u8868\u7ed3\u6784\n    \u521b\u5efa\u4e00\u4e2a\u5355\u8868\u8bbe\u8ba1\uff0c\u7528\u4e8e\u5b58\u50a8\u7528\u6237\u3001\u8d2d\u7269\u8f66\u548c\u5546\u54c1\u7edf\u8ba1\u6570\u636e\n    \"\"\"\n    dynamodb = get_dynamodb_resource()\n    \n    try:\n        # \u68c0\u67e5\u8868\u662f\u5426\u5df2\u5b58\u5728\n        existing_tables = dynamodb.meta.client.list_tables()['TableNames']\n        if TABLE_NAME in existing_tables:\n            print(f\"\u8868 {TABLE_NAME} \u5df2\u5b58\u5728\uff0c\u8df3\u8fc7\u521b\u5efa\")\n            return\n        \n        # \u521b\u5efa\u4e3b\u8868 - \u4f7f\u7528\u5355\u8868\u8bbe\u8ba1\n        # pk (Partition Key) \u548c sk (Sort Key) \u7528\u4e8e\u533a\u5206\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\uff1a\n        # - \u7528\u6237: pk='USER#{username}', sk='PROFILE'\n        # - \u8d2d\u7269\u8f66\u9879: pk='user#{userId}' \u6216 'cart#{cartId}', sk='product#{productId}'\n        # - \u5546\u54c1\u7edf\u8ba1: pk='PRODUCT#{productId}', sk='TOTAL'\n        table = dynamodb.create_table(\n            TableName=TABLE_NAME,\n            KeySchema=[\n                {'AttributeName': 'pk', 'KeyType': 'HASH'},   # Partition key\n                {'AttributeName': 'sk', 'KeyType': 'RANGE'}   # Sort key\n            ],\n            AttributeDefinitions=[\n                {'AttributeName': 'pk', 'AttributeType': 'S'},\n                {'AttributeName': 'sk', 'AttributeType': 'S'},\n                {'AttributeName': 'username', 'AttributeType': 'S'}  # GSI\n            ],\n            # \u6dfb\u52a0\u5168\u5c40\u4e8c\u7ea7\u7d22\u5f15\u7528\u4e8e\u901a\u8fc7username\u67e5\u8be2\u7528\u6237\n            GlobalSecondaryIndexes=[\n                {\n                    'IndexName': 'username-index',\n                    'KeySchema': [\n                        {'AttributeName': 'username', 'KeyType': 'HASH'}\n                    ],\n                    'Projection': {'ProjectionType': 'ALL'},\n                    'ProvisionedThroughput': {\n                        'ReadCapacityUnits': 5,\n                        'WriteCapacityUnits': 5\n                    }\n                }\n            ],\n            BillingMode='PROVISIONED',\n            ProvisionedThroughput={\n                'ReadCapacityUnits': 5,\n                'WriteCapacityUnits': 5\n            }\n        )\n        \n        # \u7b49\u5f85\u8868\u521b\u5efa\u5b8c\u6210\n        print(f\"\u6b63\u5728\u521b\u5efa\u8868 {TABLE_NAME}...\")\n        table.meta.client.get_waiter('table_exists').wait(TableName=TABLE_NAME)\n        print(f\"\u8868 {TABLE_NAME} \u521b\u5efa\u6210\u529f\uff01\")\n        \n        # \u542f\u7528TTL\uff08\u7528\u4e8e\u81ea\u52a8\u6e05\u7406\u8fc7\u671f\u7684\u8d2d\u7269\u8f66\u9879\uff09\n        try:\n            dynamodb.meta.client.update_time_to_live(\n                TableName=TABLE_NAME,\n                TimeToLiveSpecification={\n                    'Enabled': True,\n                    'AttributeName': 'expirationTime'\n                }\n            )\n            print(f\"\u8868 {TABLE_NAME} \u7684TTL\u5df2\u542f\u7528\")\n        except Exception as e:\n            print(f\"\u542f\u7528TTL\u65f6\u51fa\u9519\uff08\u53ef\u5ffd\u7565\uff09: {e}\")\n            \n    except ClientError as e:\n        if e.response['Error']['Code'] == 'ResourceInUseException':\n            print(f\"\u8868 {TABLE_NAME} \u5df2\u5b58\u5728\")\n        else:\n            print(f\"\u521b\u5efa\u8868\u65f6\u51fa\u9519: {e}\")\n            raise\n    except Exception as e:\n        print(f\"\u521d\u59cb\u5316DynamoDB\u65f6\u51fa\u9519: {e}\")\n        raise", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2755, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "eed7eac8-7256-4842-8b81-474c0ed73e7e": {"__data__": {"id_": "eed7eac8-7256-4842-8b81-474c0ed73e7e", "embedding": null, "metadata": {"file_path": "backend/init_dynamodb.py", "function_name": "main", "symbol_id": "backend.init_dynamodb.main", "type": "function", "start_line": 107, "end_line": 137}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "14b7bf22-5c83-46b9-a79d-5144cde02583", "node_type": "4", "metadata": {"file_path": "backend/init_dynamodb.py", "function_name": "main", "symbol_id": "backend.init_dynamodb.main", "type": "function", "start_line": 107, "end_line": 137}, "hash": "c32bbd144a068fdb445185baf185c6060db1ceef0ac96a02e944530fe73c6ccc", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def main():\n    \"\"\"\u4e3b\u51fd\u6570\"\"\"\n    print('========================================')\n    print('\u8d2d\u7269\u8f66\u5e94\u7528 - DynamoDB\u8868\u521d\u59cb\u5316')\n    print('========================================')\n    print(f'\u533a\u57df: {AWS_REGION}')\n    print('')\n    \n    try:\n        init_dynamodb()\n        \n        print('')\n        print('========================================')\n        print('\u2713 \u6570\u636e\u5e93\u521d\u59cb\u5316\u5b8c\u6210\uff01')\n        print('========================================')\n        print('')\n        print('\u521b\u5efa\u7684\u8868:')\n        print(f'  1. {TABLE_NAME} - \u8d2d\u7269\u8f66\u4e3b\u8868\uff08\u5355\u8868\u8bbe\u8ba1\uff09')\n        print('')\n        print('\u73b0\u5728\u53ef\u4ee5\u542f\u52a8\u5e94\u7528\u4e86:')\n        print('  python app.py')\n        print('')\n        \n    except Exception as e:\n        print('')\n        print('========================================')\n        print('\u2717 \u521d\u59cb\u5316\u5931\u8d25\uff01')\n        print('========================================')\n        print(f'\u9519\u8bef\u4fe1\u606f: {e}')\n        print('')\n        sys.exit(1)", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 872, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "49901916-bfcd-4da9-8649-8a8bd28b7097": {"__data__": {"id_": "49901916-bfcd-4da9-8649-8a8bd28b7097", "embedding": null, "metadata": {"file_path": "backend/load_products.py", "function_name": "load_products_to_dynamodb", "symbol_id": "backend.load_products.load_products_to_dynamodb", "type": "function", "start_line": 13, "end_line": 52}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "2c4eb6f7-b7a7-4600-8ba8-2fb57fff9c53", "node_type": "4", "metadata": {"file_path": "backend/load_products.py", "function_name": "load_products_to_dynamodb", "symbol_id": "backend.load_products.load_products_to_dynamodb", "type": "function", "start_line": 13, "end_line": 52}, "hash": "1f771e0d4a253490e1687b0d5bc25906d91f32bfcc380951cdadedad9dd4c86a", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def load_products_to_dynamodb():\n    \"\"\"\n    \u5c06\u4ea7\u54c1\u6570\u636e\u52a0\u8f7d\u5230DynamoDB\n    \u4ea7\u54c1\u8bb0\u5f55\u683c\u5f0f: pk='PRODUCT#{productId}', sk='DETAIL'\n    \"\"\"\n    # \u8bfb\u53d6\u4ea7\u54c1\u6570\u636e\n    current_dir = os.path.dirname(os.path.abspath(__file__))\n    product_file = os.path.join(current_dir, 'product_list.json')\n    \n    print(f\"\u6b63\u5728\u8bfb\u53d6\u4ea7\u54c1\u6570\u636e: {product_file}\")\n    with open(product_file, 'r', encoding='utf-8') as f:\n        products = json.load(f)\n    \n    print(f\"\u627e\u5230 {len(products)} \u4e2a\u4ea7\u54c1\")\n    \n    # \u83b7\u53d6DynamoDB\u8868\n    table = get_table()\n    \n    # \u6279\u91cf\u5199\u5165\u4ea7\u54c1\u6570\u636e\n    print(\"\u5f00\u59cb\u5199\u5165DynamoDB...\")\n    with table.batch_writer() as batch:\n        for product in products:\n            product_id = product['productId']\n            \n            # \u4ea7\u54c1\u8be6\u60c5\u8bb0\u5f55\n            item = {\n                'pk': f'PRODUCT#{product_id}',\n                'sk': 'DETAIL',\n                'productId': product_id,\n                'name': product.get('name', ''),\n                'price': product.get('price', 0),\n                'description': product.get('description', ''),\n                'picture': product.get('picture', ''),\n                'created_at': datetime.now().isoformat()\n            }\n            \n            batch.put_item(Item=item)\n            print(f\"  - \u5df2\u52a0\u8f7d: {product.get('name', product_id)}\")\n    \n    print(f\"\\n\u2713 \u6210\u529f\u52a0\u8f7d {len(products)} \u4e2a\u4ea7\u54c1\u5230DynamoDB\uff01\")", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1286, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "a36389c5-c4c7-46f0-a14c-5427b3e021b5": {"__data__": {"id_": "a36389c5-c4c7-46f0-a14c-5427b3e021b5", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "_python_obj_to_dynamodb", "symbol_id": "backend.models._python_obj_to_dynamodb", "type": "function", "start_line": 19, "end_line": 31}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "83e9b36c-4347-42e7-ad10-7100a6413811", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "_python_obj_to_dynamodb", "symbol_id": "backend.models._python_obj_to_dynamodb", "type": "function", "start_line": 19, "end_line": 31}, "hash": "3489b6ef73f33ebab51dce110399c11dfae76808ee8d546ef6930938209eae01", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def _python_obj_to_dynamodb(obj):\n    \"\"\"\n    \u5c06Python\u5bf9\u8c61\u8f6c\u6362\u4e3aDynamoDB\u517c\u5bb9\u7684\u683c\u5f0f\n    \u4e3b\u8981\u5904\u7406float\u5230Decimal\u7684\u8f6c\u6362\n    \"\"\"\n    if isinstance(obj, dict):\n        return {k: _python_obj_to_dynamodb(v) for k, v in obj.items()}\n    elif isinstance(obj, list):\n        return [_python_obj_to_dynamodb(item) for item in obj]\n    elif isinstance(obj, float):\n        return Decimal(str(obj))\n    else:\n        return obj", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 395, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "e3e79a60-de2b-4296-8a0f-3aaba6f760e8": {"__data__": {"id_": "e3e79a60-de2b-4296-8a0f-3aaba6f760e8", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "_dynamodb_to_python_obj", "symbol_id": "backend.models._dynamodb_to_python_obj", "type": "function", "start_line": 34, "end_line": 50}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "35f228f7-8adb-4f50-b0e3-be7c1ac4f766", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "_dynamodb_to_python_obj", "symbol_id": "backend.models._dynamodb_to_python_obj", "type": "function", "start_line": 34, "end_line": 50}, "hash": "ad25146250fe5f86a6c8482cfed6841a016b324e368811e8ab12d2ed991ba070", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def _dynamodb_to_python_obj(obj):\n    \"\"\"\n    \u5c06DynamoDB\u5bf9\u8c61\u8f6c\u6362\u4e3aPython\u6807\u51c6\u5bf9\u8c61\n    \u4e3b\u8981\u5904\u7406Decimal\u5230float\u7684\u8f6c\u6362\n    \"\"\"\n    if isinstance(obj, dict):\n        return {k: _dynamodb_to_python_obj(v) for k, v in obj.items()}\n    elif isinstance(obj, list):\n        return [_dynamodb_to_python_obj(item) for item in obj]\n    elif isinstance(obj, Decimal):\n        # \u5982\u679c\u662f\u6574\u6570\uff0c\u8fd4\u56deint\uff1b\u5426\u5219\u8fd4\u56defloat\n        if obj % 1 == 0:\n            return int(obj)\n        else:\n            return float(obj)\n    else:\n        return obj", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 492, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "12de9655-afdb-49af-b9b2-702c9318eaaf": {"__data__": {"id_": "12de9655-afdb-49af-b9b2-702c9318eaaf", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "create_user", "symbol_id": "backend.models.create_user", "type": "function", "start_line": 55, "end_line": 93}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "864e20e7-b528-450a-b664-5ca9d7a023cd", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "create_user", "symbol_id": "backend.models.create_user", "type": "function", "start_line": 55, "end_line": 93}, "hash": "537d1b562e9a7b165c50cf70b7e52462a0c6fc81f4cc4e2d03683c9d77d06a9f", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def create_user(username, password, email=None):\n    \"\"\"\n    \u521b\u5efa\u65b0\u7528\u6237\n    \n    Args:\n        username: \u7528\u6237\u540d\n        password: \u660e\u6587\u5bc6\u7801\n        email: \u90ae\u7bb1\uff08\u53ef\u9009\uff09\n    \n    Returns:\n        \u7528\u6237ID\n    \"\"\"\n    table = get_table()\n    user_id = str(uuid4())\n    password_hash = hash_password(password)\n    \n    # \u7528\u6237\u8bb0\u5f55: pk='USER#{username}', sk='PROFILE'\n    item = {\n        'pk': f'USER#{username}',\n        'sk': 'PROFILE',\n        'id': user_id,\n        'username': username,\n        'password_hash': password_hash,\n        'email': email,\n        'created_at': datetime.now().isoformat()\n    }\n    \n    try:\n        # \u4f7f\u7528\u6761\u4ef6\u8868\u8fbe\u5f0f\u786e\u4fdd\u7528\u6237\u540d\u552f\u4e00\n        table.put_item(\n            Item=item,\n            ConditionExpression='attribute_not_exists(pk)'\n        )\n    except ClientError as e:\n        if e.response['Error']['Code'] == 'ConditionalCheckFailedException':\n            raise Exception(f'\u7528\u6237\u540d {username} \u5df2\u5b58\u5728')\n        raise\n    \n    return user_id", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 928, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "f77f7f93-ca10-4c13-93bc-9ed41100ffd1": {"__data__": {"id_": "f77f7f93-ca10-4c13-93bc-9ed41100ffd1", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "get_user_by_username", "symbol_id": "backend.models.get_user_by_username", "type": "function", "start_line": 96, "end_line": 121}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "16bcc082-baab-4e9a-941b-0ab5565ba9f0", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "get_user_by_username", "symbol_id": "backend.models.get_user_by_username", "type": "function", "start_line": 96, "end_line": 121}, "hash": "cab50050c66a350bcb666c8a802691809410e0108d84cc7ee2755cb89a2532da", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_user_by_username(username):\n    \"\"\"\n    \u6839\u636e\u7528\u6237\u540d\u83b7\u53d6\u7528\u6237\u4fe1\u606f\n    \n    Args:\n        username: \u7528\u6237\u540d\n    \n    Returns:\n        \u7528\u6237\u5b57\u5178\u6216None\n    \"\"\"\n    table = get_table()\n    \n    try:\n        response = table.get_item(\n            Key={\n                'pk': f'USER#{username}',\n                'sk': 'PROFILE'\n            }\n        )\n        \n        if 'Item' in response:\n            return _dynamodb_to_python_obj(response['Item'])\n        return None\n    except Exception as e:\n        print(f\"\u83b7\u53d6\u7528\u6237\u5931\u8d25: {e}\")\n        return None", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 527, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "f4db15e3-1f78-4321-97eb-3f77eb5cadf6": {"__data__": {"id_": "f4db15e3-1f78-4321-97eb-3f77eb5cadf6", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "get_user_by_id", "symbol_id": "backend.models.get_user_by_id", "type": "function", "start_line": 124, "end_line": 148}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7d8c2056-a7b8-4921-98cb-976d32af1bf3", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "get_user_by_id", "symbol_id": "backend.models.get_user_by_id", "type": "function", "start_line": 124, "end_line": 148}, "hash": "e718e45161e0889d372254355a7c6ddc25c59250d2780c73f2582cfb39d2c562", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_user_by_id(user_id):\n    \"\"\"\n    \u6839\u636e\u7528\u6237ID\u83b7\u53d6\u7528\u6237\u4fe1\u606f\n    \n    Args:\n        user_id: \u7528\u6237ID\n    \n    Returns:\n        \u7528\u6237\u5b57\u5178\u6216None\n    \"\"\"\n    table = get_table()\n    \n    # \u7531\u4e8e\u6211\u4eec\u4f7f\u7528username\u4f5c\u4e3a\u4e3b\u952e\u7684\u4e00\u90e8\u5206\uff0c\u9700\u8981\u626b\u63cf\u8868\n    # \u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5efa\u8bae\u6dfb\u52a0GSI\u6765\u4f18\u5316\u8fd9\u4e2a\u67e5\u8be2\n    try:\n        response = table.scan(\n            FilterExpression=Attr('id').eq(user_id) & Attr('sk').eq('PROFILE')\n        )\n        \n        if response['Items']:\n            return _dynamodb_to_python_obj(response['Items'][0])\n        return None\n    except Exception as e:\n        print(f\"\u83b7\u53d6\u7528\u6237\u5931\u8d25: {e}\")\n        return None", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 556, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "4f31569f-2c1d-4a4b-87a8-468cb7b3e9c8": {"__data__": {"id_": "4f31569f-2c1d-4a4b-87a8-468cb7b3e9c8", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "get_cart_items", "symbol_id": "backend.models.get_cart_items", "type": "function", "start_line": 153, "end_line": 205}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "421ca100-6d2f-48c4-b32a-d9c2ad2aa3c7", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "get_cart_items", "symbol_id": "backend.models.get_cart_items", "type": "function", "start_line": 153, "end_line": 205}, "hash": "e193ef0a04f8313fb535b78baa00e8bd8db6cb77190bdbb21457780dc884a8dc", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_cart_items(pk):\n    \"\"\"\n    \u83b7\u53d6\u8d2d\u7269\u8f66\u4e2d\u7684\u6240\u6709\u5546\u54c1\n    \n    Args:\n        pk: \u4e3b\u952e\uff08user#xxx \u6216 cart#xxx\uff09\n    \n    Returns:\n        \u5546\u54c1\u5217\u8868\n    \"\"\"\n    table = get_table()\n    \n    try:\n        # \u67e5\u8be2\u8d2d\u7269\u8f66\u9879\uff0c\u53ea\u83b7\u53d6product#\u5f00\u5934\u7684\u9879\n        response = table.query(\n            KeyConditionExpression=Key('pk').eq(pk) & Key('sk').begins_with('product#')\n        )\n        \n        items = []\n        current_time = datetime.now()\n        \n        for item in response['Items']:\n            # \u8fc7\u6ee4\u6389\u6570\u91cf\u4e3a0\u548c\u5df2\u8fc7\u671f\u7684\u9879\n            quantity = item.get('quantity', 0)\n            if quantity <= 0:\n                continue\n            \n            # \u68c0\u67e5\u662f\u5426\u8fc7\u671f\n            expiration_time = item.get('expirationTime')\n            if expiration_time:\n                # DynamoDB\u7684TTL\u662fUnix\u65f6\u95f4\u6233\uff08\u79d2\uff09\n                # \u9700\u8981\u5c06Decimal\u8f6c\u6362\u4e3aint\u6216float\n                if isinstance(expiration_time, Decimal):\n                    expiration_time = int(expiration_time)\n                exp_datetime = datetime.fromtimestamp(expiration_time)\n                if exp_datetime < current_time:\n                    continue\n            \n            # \u89e3\u6790product_detail\n            product_detail = item.get('product_detail')\n            if product_detail and isinstance(product_detail, str):\n                product_detail = json.loads(product_detail)\n            \n            items.append({\n                'sk': item['sk'],\n                'quantity': int(quantity) if isinstance(quantity, Decimal) else quantity,\n                'productDetail': _dynamodb_to_python_obj(product_detail)\n            })\n        \n        return items\n    except Exception as e:\n        print(f\"\u83b7\u53d6\u8d2d\u7269\u8f66\u5931\u8d25: {e}\")\n        return []", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1637, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "eba260d9-17ac-44e2-8454-0a802055bc27": {"__data__": {"id_": "eba260d9-17ac-44e2-8454-0a802055bc27", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "add_cart_item", "symbol_id": "backend.models.add_cart_item", "type": "function", "start_line": 208, "end_line": 249}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5a43127c-ecbf-43fd-b4d3-365bd6c41f72", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "add_cart_item", "symbol_id": "backend.models.add_cart_item", "type": "function", "start_line": 208, "end_line": 249}, "hash": "40970fb64349466e3b221d52a364f7b26747fcfa886e1ca5e44e7bedcd34e4c0", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def add_cart_item(pk, product_id, quantity, product_detail, expiration_time):\n    \"\"\"\n    \u6dfb\u52a0\u6216\u66f4\u65b0\u8d2d\u7269\u8f66\u9879\uff08\u589e\u52a0\u6570\u91cf\uff09\n    \n    Args:\n        pk: \u4e3b\u952e\uff08user#xxx \u6216 cart#xxx\uff09\n        product_id: \u4ea7\u54c1ID\n        quantity: \u6570\u91cf\uff08\u53ef\u4ee5\u662f\u8d1f\u6570\uff09\n        product_detail: \u4ea7\u54c1\u8be6\u60c5\u5b57\u5178\n        expiration_time: \u8fc7\u671f\u65f6\u95f4\uff08datetime\u5bf9\u8c61\uff09\n    \"\"\"\n    table = get_table()\n    sk = f\"product#{product_id}\"\n    \n    # \u8f6c\u6362\u8fc7\u671f\u65f6\u95f4\u4e3aUnix\u65f6\u95f4\u6233\uff08DynamoDB TTL\u683c\u5f0f\uff09\n    ttl = int(expiration_time.timestamp()) if expiration_time else None\n    \n    # \u8f6c\u6362product_detail\u4e3aJSON\u5b57\u7b26\u4e32\n    product_detail_json = json.dumps(_python_obj_to_dynamodb(product_detail))\n    \n    try:\n        # \u4f7f\u7528UpdateItem\u5b9e\u73b0\u539f\u5b50\u6027\u7684\u589e\u91cf\u66f4\u65b0\n        response = table.update_item(\n            Key={'pk': pk, 'sk': sk},\n            UpdateExpression='ADD quantity :qty SET product_detail = :detail, expirationTime = :ttl, updated_at = :now',\n            ExpressionAttributeValues={\n                ':qty': quantity,\n                ':detail': product_detail_json,\n                ':ttl': ttl,\n                ':now': datetime.now().isoformat()\n            },\n            ReturnValues='ALL_NEW'\n        )\n        \n        # \u5982\u679c\u66f4\u65b0\u540e\u6570\u91cf\u5c0f\u4e8e\u7b49\u4e8e0\uff0c\u5220\u9664\u8be5\u9879\n        new_quantity = response['Attributes'].get('quantity', 0)\n        if new_quantity <= 0:\n            table.delete_item(Key={'pk': pk, 'sk': sk})\n            \n    except Exception as e:\n        print(f\"\u6dfb\u52a0\u8d2d\u7269\u8f66\u9879\u5931\u8d25: {e}\")\n        raise", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1355, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "bc25adfb-2067-40ab-9745-98c98f4f5709": {"__data__": {"id_": "bc25adfb-2067-40ab-9745-98c98f4f5709", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "update_cart_item_quantity", "symbol_id": "backend.models.update_cart_item_quantity", "type": "function", "start_line": 252, "end_line": 290}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6da7c430-5a30-48b1-a86e-a2f72616e8f4", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "update_cart_item_quantity", "symbol_id": "backend.models.update_cart_item_quantity", "type": "function", "start_line": 252, "end_line": 290}, "hash": "2ad6ad8b9a86d07c0165eedc98e2b394a76a6ac18818383cc8bfba7ac8c282c8", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def update_cart_item_quantity(pk, product_id, quantity, product_detail, expiration_time):\n    \"\"\"\n    \u66f4\u65b0\u8d2d\u7269\u8f66\u9879\u6570\u91cf\uff08\u5e42\u7b49\u64cd\u4f5c\uff0c\u76f4\u63a5\u8bbe\u7f6e\u4e3a\u6307\u5b9a\u6570\u91cf\uff09\n    \n    Args:\n        pk: \u4e3b\u952e\uff08user#xxx \u6216 cart#xxx\uff09\n        product_id: \u4ea7\u54c1ID\n        quantity: \u6570\u91cf\n        product_detail: \u4ea7\u54c1\u8be6\u60c5\u5b57\u5178\n        expiration_time: \u8fc7\u671f\u65f6\u95f4\uff08datetime\u5bf9\u8c61\uff09\n    \"\"\"\n    table = get_table()\n    sk = f\"product#{product_id}\"\n    \n    # \u8f6c\u6362\u8fc7\u671f\u65f6\u95f4\u4e3aUnix\u65f6\u95f4\u6233\n    ttl = int(expiration_time.timestamp()) if expiration_time else None\n    \n    # \u8f6c\u6362product_detail\u4e3aJSON\u5b57\u7b26\u4e32\n    product_detail_json = json.dumps(_python_obj_to_dynamodb(product_detail))\n    \n    try:\n        if quantity <= 0:\n            # \u6570\u91cf\u4e3a0\u6216\u8d1f\u6570\uff0c\u5220\u9664\u8be5\u9879\n            table.delete_item(Key={'pk': pk, 'sk': sk})\n        else:\n            # \u76f4\u63a5\u8bbe\u7f6e\u6570\u91cf\n            table.put_item(\n                Item={\n                    'pk': pk,\n                    'sk': sk,\n                    'quantity': quantity,\n                    'product_detail': product_detail_json,\n                    'expirationTime': ttl,\n                    'updated_at': datetime.now().isoformat()\n                }\n            )\n    except Exception as e:\n        print(f\"\u66f4\u65b0\u8d2d\u7269\u8f66\u9879\u5931\u8d25: {e}\")\n        raise", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1152, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "67f650ad-6702-4a49-933d-548459110d6c": {"__data__": {"id_": "67f650ad-6702-4a49-933d-548459110d6c", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "delete_cart_items", "symbol_id": "backend.models.delete_cart_items", "type": "function", "start_line": 293, "end_line": 319}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7f9c2fe6-62f5-412e-81bf-69cac9a6cc10", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "delete_cart_items", "symbol_id": "backend.models.delete_cart_items", "type": "function", "start_line": 293, "end_line": 319}, "hash": "642523e903f8bd81d4edc20342d1334714120f8465bbcc6fb39e7c2911795c25", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def delete_cart_items(pk):\n    \"\"\"\n    \u5220\u9664\u6307\u5b9a\u7528\u6237/\u8d2d\u7269\u8f66\u7684\u6240\u6709\u5546\u54c1\n    \n    Args:\n        pk: \u4e3b\u952e\uff08user#xxx \u6216 cart#xxx\uff09\n    \"\"\"\n    table = get_table()\n    \n    try:\n        # \u5148\u67e5\u8be2\u6240\u6709\u8d2d\u7269\u8f66\u9879\n        response = table.query(\n            KeyConditionExpression=Key('pk').eq(pk) & Key('sk').begins_with('product#')\n        )\n        \n        # \u6279\u91cf\u5220\u9664\n        with table.batch_writer() as batch:\n            for item in response['Items']:\n                batch.delete_item(\n                    Key={\n                        'pk': item['pk'],\n                        'sk': item['sk']\n                    }\n                )\n    except Exception as e:\n        print(f\"\u5220\u9664\u8d2d\u7269\u8f66\u9879\u5931\u8d25: {e}\")\n        raise", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 669, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "ecbdfc95-d678-44b2-85a7-729058938a8e": {"__data__": {"id_": "ecbdfc95-d678-44b2-85a7-729058938a8e", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "migrate_cart_items", "symbol_id": "backend.models.migrate_cart_items", "type": "function", "start_line": 322, "end_line": 405}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f92a48ff-36ed-45e4-99e6-e81a7099df4b", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "migrate_cart_items", "symbol_id": "backend.models.migrate_cart_items", "type": "function", "start_line": 322, "end_line": 405}, "hash": "91f31d8bc68c496d0541a668ebbe73acbf373da1528f333b8bf63c4a9d577790", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def migrate_cart_items(anonymous_pk, user_pk):\n    \"\"\"\n    \u5c06\u533f\u540d\u8d2d\u7269\u8f66\u8fc1\u79fb\u5230\u7528\u6237\u8d26\u6237\n    \n    Args:\n        anonymous_pk: \u533f\u540d\u8d2d\u7269\u8f66\u4e3b\u952e\uff08cart#xxx\uff09\n        user_pk: \u7528\u6237\u4e3b\u952e\uff08user#xxx\uff09\n    \n    Returns:\n        \u8fc1\u79fb\u7684\u5546\u54c1\u5217\u8868\n    \"\"\"\n    table = get_table()\n    \n    try:\n        # \u83b7\u53d6\u533f\u540d\u8d2d\u7269\u8f66\u7684\u6240\u6709\u5546\u54c1\n        response = table.query(\n            KeyConditionExpression=Key('pk').eq(anonymous_pk) & Key('sk').begins_with('product#')\n        )\n        \n        anonymous_items = response['Items']\n        migrated_items = []\n        \n        # \u8fc1\u79fb\u5230\u7528\u6237\u8d26\u6237\n        for item in anonymous_items:\n            sk = item['sk']\n            quantity = item.get('quantity', 0)\n            # \u5904\u7406Decimal\u7c7b\u578b\n            if isinstance(quantity, Decimal):\n                quantity = int(quantity)\n            product_detail = item.get('product_detail')\n            \n            if quantity <= 0:\n                continue\n            \n            # \u8bbe\u7f6e\u65b0\u7684\u8fc7\u671f\u65f6\u95f4\uff08\u5df2\u767b\u5f55\u7528\u6237\u4fdd\u755930\u5929\uff09\n            expiration_time = datetime.now() + timedelta(days=30)\n            ttl = int(expiration_time.timestamp())\n            \n            # \u68c0\u67e5\u7528\u6237\u8d2d\u7269\u8f66\u662f\u5426\u5df2\u6709\u6b64\u5546\u54c1\n            try:\n                user_response = table.get_item(Key={'pk': user_pk, 'sk': sk})\n                \n                if 'Item' in user_response:\n                    # \u5df2\u5b58\u5728\u5219\u7d2f\u52a0\u6570\u91cf\uff08\u4f7f\u7528\u539f\u5b50\u6027ADD\u64cd\u4f5c\uff09\n                    table.update_item(\n                        Key={'pk': user_pk, 'sk': sk},\n                        UpdateExpression='ADD quantity :qty SET product_detail = :detail, expirationTime = :ttl, updated_at = :now',\n                        ExpressionAttributeValues={\n                            ':qty': quantity,\n                            ':detail': product_detail,\n                            ':ttl': ttl,\n                            ':now': datetime.now().isoformat()\n                        }\n                    )\n                else:\n                    # \u4e0d\u5b58\u5728\u5219\u63d2\u5165\n                    table.put_item(\n                        Item={\n                            'pk': user_pk,\n                            'sk': sk,\n                            'quantity': quantity,\n                            'product_detail': product_detail,\n                            'expirationTime': ttl,\n                            'updated_at': datetime.now().isoformat()\n                        }\n                    )\n            except Exception as e:\n                print(f\"\u8fc1\u79fb\u5546\u54c1 {sk} \u5931\u8d25: {e}\")\n                continue\n            \n            migrated_items.append({\n                'sk': sk,\n                'quantity': quantity,\n                'product_detail': product_detail\n            })\n        \n        # \u5220\u9664\u533f\u540d\u8d2d\u7269\u8f66\u7684\u5546\u54c1\n        delete_cart_items(anonymous_pk)\n        \n        return migrated_items\n        \n    except Exception as e:\n        print(f\"\u8fc1\u79fb\u8d2d\u7269\u8f66\u5931\u8d25: {e}\")\n        raise", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2747, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "60471ab0-e28e-4ecc-a552-2b27433f01c7": {"__data__": {"id_": "60471ab0-e28e-4ecc-a552-2b27433f01c7", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "get_product_total_quantity", "symbol_id": "backend.models.get_product_total_quantity", "type": "function", "start_line": 410, "end_line": 436}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "52c1491d-f736-4512-8345-02833a9dce21", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "get_product_total_quantity", "symbol_id": "backend.models.get_product_total_quantity", "type": "function", "start_line": 410, "end_line": 436}, "hash": "2bb54f5f2badf6c82b27479e36a54f146bd643f03383e0e6e9aa5d9089732aa7", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def get_product_total_quantity(product_id):\n    \"\"\"\n    \u83b7\u53d6\u6307\u5b9a\u5546\u54c1\u5728\u6240\u6709\u8d2d\u7269\u8f66\u4e2d\u7684\u603b\u6570\u91cf\n    \n    Args:\n        product_id: \u4ea7\u54c1ID\n    \n    Returns:\n        \u603b\u6570\u91cf\n    \"\"\"\n    table = get_table()\n    \n    try:\n        response = table.get_item(\n            Key={\n                'pk': f'PRODUCT#{product_id}',\n                'sk': 'TOTAL'\n            }\n        )\n        \n        if 'Item' in response:\n            total = response['Item'].get('total_quantity', 0)\n            return int(total) if isinstance(total, Decimal) else total\n        return 0\n    except Exception as e:\n        print(f\"\u83b7\u53d6\u5546\u54c1\u7edf\u8ba1\u5931\u8d25: {e}\")\n        return 0", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 609, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "5168c827-fd02-433b-8ce9-a89135567bfb": {"__data__": {"id_": "5168c827-fd02-433b-8ce9-a89135567bfb", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "update_product_total_quantity", "symbol_id": "backend.models.update_product_total_quantity", "type": "function", "start_line": 439, "end_line": 488}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "1ccdfadd-b678-47ab-9f23-3580fb18509d", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "update_product_total_quantity", "symbol_id": "backend.models.update_product_total_quantity", "type": "function", "start_line": 439, "end_line": 488}, "hash": "7a5e5438928de6be3318ee5a1f0d56882099e6e34a3b3b76c23920b5b3432f25", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def update_product_total_quantity(product_id, quantity_change):\n    \"\"\"\n    \u66f4\u65b0\u5546\u54c1\u7684\u603b\u6570\u91cf\u7edf\u8ba1\uff08\u589e\u91cf\u66f4\u65b0\uff09\n    \n    Args:\n        product_id: \u4ea7\u54c1ID\n        quantity_change: \u6570\u91cf\u53d8\u5316\uff08\u53ef\u4ee5\u662f\u6b63\u6570\u6216\u8d1f\u6570\uff09\n    \"\"\"\n    table = get_table()\n    pk = f'PRODUCT#{product_id}'\n    sk = 'TOTAL'\n    \n    try:\n        # \u4f7f\u7528\u539f\u5b50\u6027\u7684ADD\u64cd\u4f5c\n        response = table.update_item(\n            Key={'pk': pk, 'sk': sk},\n            UpdateExpression='ADD total_quantity :change SET updated_at = :now',\n            ExpressionAttributeValues={\n                ':change': quantity_change,\n                ':now': datetime.now().isoformat()\n            },\n            ReturnValues='ALL_NEW'\n        )\n        \n        # \u5982\u679c\u603b\u6570\u5c0f\u4e8e0\uff0c\u91cd\u7f6e\u4e3a0\n        new_total = response['Attributes'].get('total_quantity', 0)\n        if new_total < 0:\n            table.update_item(\n                Key={'pk': pk, 'sk': sk},\n                UpdateExpression='SET total_quantity = :zero',\n                ExpressionAttributeValues={':zero': 0}\n            )\n    except ClientError as e:\n        if e.response['Error']['Code'] == 'ValidationException':\n            # \u5982\u679c\u8bb0\u5f55\u4e0d\u5b58\u5728\uff0c\u521b\u5efa\u65b0\u8bb0\u5f55\n            initial_total = max(0, quantity_change)\n            table.put_item(\n                Item={\n                    'pk': pk,\n                    'sk': sk,\n                    'total_quantity': initial_total,\n                    'updated_at': datetime.now().isoformat()\n                }\n            )\n        else:\n            print(f\"\u66f4\u65b0\u5546\u54c1\u7edf\u8ba1\u5931\u8d25: {e}\")\n            raise\n    except Exception as e:\n        print(f\"\u66f4\u65b0\u5546\u54c1\u7edf\u8ba1\u5931\u8d25: {e}\")\n        raise", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1545, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "87bd9e78-18ba-484c-a152-f7c4155c1e71": {"__data__": {"id_": "87bd9e78-18ba-484c-a152-f7c4155c1e71", "embedding": null, "metadata": {"file_path": "backend/models.py", "function_name": "cleanup_expired_items", "symbol_id": "backend.models.cleanup_expired_items", "type": "function", "start_line": 493, "end_line": 521}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "97275af1-e424-4951-8227-08dea6ced84d", "node_type": "4", "metadata": {"file_path": "backend/models.py", "function_name": "cleanup_expired_items", "symbol_id": "backend.models.cleanup_expired_items", "type": "function", "start_line": 493, "end_line": 521}, "hash": "9ae65235632fb3d015c94a76ff36dcaa8a4606f737a7d49d42fe5aaf1009f7cf", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "def cleanup_expired_items():\n    \"\"\"\n    \u6e05\u7406\u8fc7\u671f\u7684\u8d2d\u7269\u8f66\u9879\n    \u6ce8\u610f\uff1aDynamoDB\u7684TTL\u4f1a\u81ea\u52a8\u6e05\u7406\u8fc7\u671f\u9879\uff0c\u6b64\u51fd\u6570\u4f5c\u4e3a\u5907\u7528\u624b\u52a8\u6e05\u7406\n    \"\"\"\n    table = get_table()\n    current_timestamp = int(datetime.now().timestamp())\n    \n    try:\n        # \u626b\u63cf\u6240\u6709\u8fc7\u671f\u7684\u8d2d\u7269\u8f66\u9879\n        response = table.scan(\n            FilterExpression=Attr('expirationTime').exists() & Attr('expirationTime').lt(current_timestamp)\n        )\n        \n        deleted_count = 0\n        with table.batch_writer() as batch:\n            for item in response['Items']:\n                batch.delete_item(\n                    Key={\n                        'pk': item['pk'],\n                        'sk': item['sk']\n                    }\n                )\n                deleted_count += 1\n        \n        return deleted_count\n    except Exception as e:\n        print(f\"\u6e05\u7406\u8fc7\u671f\u9879\u5931\u8d25: {e}\")\n        return 0", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 817, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "343d7ca2-d5fc-43fc-b968-32b6b8af11cb": {"__data__": {"id_": "343d7ca2-d5fc-43fc-b968-32b6b8af11cb", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "14f02a56-7657-4499-8046-2c2664bcc6b1", "node_type": "4", "metadata": {}, "hash": "75ead7167ee17e0dc14b8d6ef75e023547a5adf52fae0b184906523dbefce086", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "module.exports = {\n  \"transpileDependencies\": [\n    \"vuetify\",\n     'aws-amplify',\n    '@aws-amplify'\n  ],\n  lintOnSave: false,\n  // \u6784\u5efa\u8f93\u51fa\u76ee\u5f55\n  outputDir: 'dist',\n  // \u5f00\u53d1\u670d\u52a1\u5668\u914d\u7f6e\n  devServer: {\n    port: 8080,\n    proxy: {\n      // \u4ee3\u7406\u6240\u6709/auth\u3001/cart\u3001/product\u8bf7\u6c42\u5230\u540e\u7aefFlask\u670d\u52a1\n      '^/(auth|cart|product)': {\n        target: 'http://localhost:5000',\n        changeOrigin: true,\n        ws: false\n      }\n    }\n  }\n}", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 403, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "89a02f03-33fa-4ffd-aebd-341c00973994": {"__data__": {"id_": "89a02f03-33fa-4ffd-aebd-341c00973994", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5cf83985-6982-4b86-9037-6ff48460dcf0", "node_type": "4", "metadata": {}, "hash": "8fdb08383b22a744bda4432ad73e2e66dd6f1226c4fb3d74c7834fe5de19df8b", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "process.env.AWS_SDK_LOAD_CONFIG = true;\nvar fs = require('fs');\n\nvar args = process.argv.slice(2);\nvar envtype = args[0] ? args[0] : ''\nvar AWS = require('aws-sdk');\nvar ssm = new AWS.SSM();\n\n\nconst query = {\n    \"Path\": \"/serverless-shopping-cart-demo/\",\n    \"WithDecryption\": false,\n    \"Recursive\": true\n}\n\nconst requiredParams = [\"CART_API_URL\", \"PRODUCTS_API_URL\", \"USER_POOL_ID\",\n    \"USER_POOL_CLIENT_ID\"\n]\n\nvar params = ssm.getParametersByPath(query).promise()\n\nvar output = []\n\nfunction formatParams(data) {\n    for (var param of data) {\n        const paramName = param.Name.toUpperCase().split(\"/\").pop().replace(/-/g, \"_\")\n        if (requiredParams.includes(paramName)) {\n            output.push(\"VUE_APP_\" + paramName + '=' + param.Value)\n        }\n    }\n}\n\nparams\n    .then(data => {\n        formatParams(data.Parameters)\n        output.push(\"VUE_APP_AWS_REGION=\" + AWS.config.region)\n        var fileName\n        if (envtype) {\n            fileName = \"./.env.\" + envtype\n        }\n        else {\n            fileName = \"./.env\"\n        }\n        fs.writeFile(fileName, output.join('\\n'), function (err) {\n            if (err) {\n                return console.log(err);  // eslint-disable-line no-console\n            }\n            console.log(`env file ${fileName} populated with config`);  // eslint-disable-line no-console\n        });\n\n    })\n    .catch(error => {\n        console.log('error: ' + error)  // eslint-disable-line no-console\n    })", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1461, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "8583bc50-f980-4145-bbfe-37b65cb0f93d": {"__data__": {"id_": "8583bc50-f980-4145-bbfe-37b65cb0f93d", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "39df17a6-3479-4878-ab69-d966a7954d1d", "node_type": "4", "metadata": {}, "hash": "9809f14f8e8e773aea6fa53fa9a48ea55550eea2a43e445f38a455a9bc70de73", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "const awsmobile = {\n  Auth: {\n    region: process.env.VUE_APP_AWS_REGION,\n    userPoolId: process.env.VUE_APP_USER_POOL_ID,\n    userPoolWebClientId: process.env.VUE_APP_USER_POOL_CLIENT_ID\n  },\n  API: {\n    endpoints: [{\n        name: \"CartAPI\",\n        endpoint: process.env.VUE_APP_CART_API_URL\n      },\n      {\n        name: \"ProductAPI\",\n        endpoint: process.env.VUE_APP_PRODUCTS_API_URL,\n      }\n    ]\n  }\n};\n\nexport default awsmobile;", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 445, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "69da2980-2203-438a-86b1-6279e151b499": {"__data__": {"id_": "69da2980-2203-438a-86b1-6279e151b499", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "56fabde6-6c71-4da5-aa03-d5c9bbde0fb2", "node_type": "4", "metadata": {}, "hash": "247d9f3370d246ffa76176ba5c6ccb1908a9deece33dcd1a61758ca2c3e9b65d", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "import VueRouter from 'vue-router'\nimport Vue from 'vue';\nimport store from '@/store/store.js'\nimport Home from '@/views/Home.vue'\nimport Payment from '@/views/Payment.vue'\nimport Auth from '@/views/Auth.vue'\nimport { getCurrentUser } from '@/backend/api.js'\n\n// \u83b7\u53d6\u5f53\u524d\u7528\u6237\uff08\u4ecelocalStorage\uff09\nfunction getUser() {\n  const user = getCurrentUser()\n  if (user) {\n    store.commit('setUser', user)\n    return Promise.resolve(user)\n  }\n  return Promise.resolve(null)\n}\nconst routes = [{\n    path: '/',\n    component: Home\n  },\n  {\n    path: '/auth',\n    name: 'Authenticator',\n    component: Auth\n  }, {\n    path: '/checkout',\n    component: Payment,\n    meta: {\n      requiresAuth: true\n    }\n  }\n]\n\nconst router = new VueRouter({\n  mode: 'history',\n  routes\n})\n\nrouter.beforeResolve(async (to, from, next) => {\n  if (to.matched.some(record => record.meta.requiresAuth)) {\n    let user = await getUser();\n    if (!user) {\n      return next({\n        path: '/auth',\n        query: {\n          redirect: to.fullPath,\n        }\n      });\n    }\n    return next()\n  }\n  return next()\n})\n\nexport default router", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1092, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "31d7768f-47fd-4752-986a-98426498c1bf": {"__data__": {"id_": "31d7768f-47fd-4752-986a-98426498c1bf", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "891d0708-3cde-46b0-a8b6-0219e474cd92", "node_type": "4", "metadata": {}, "hash": "a8428da1c01e22e36e6631b518ae0ad8fd019612b2874709f6f171382f263d6a", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "import axios from 'axios'\n\n// \u914d\u7f6eaxios\u57fa\u7840URL\uff08\u5f00\u53d1\u73af\u5883\u4ee3\u7406\u5230\u540e\u7aef\uff0c\u751f\u4ea7\u73af\u5883\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff09\nconst apiClient = axios.create({\n    baseURL: process.env.VUE_APP_API_BASE_URL || '',\n    withCredentials: true,\n    headers: {\n        'Content-Type': 'application/json'\n    }\n})\n\n// \u8bf7\u6c42\u62e6\u622a\u5668 - \u81ea\u52a8\u6dfb\u52a0\u8ba4\u8bc1token\napiClient.interceptors.request.use(\n    config => {\n        const token = localStorage.getItem('authToken')\n        if (token) {\n            config.headers['Authorization'] = `Bearer ${token}`\n        }\n        return config\n    },\n    error => {\n        return Promise.reject(error)\n    }\n)\n\n// \u54cd\u5e94\u62e6\u622a\u5668 - \u5904\u7406401\u9519\u8bef\napiClient.interceptors.response.use(\n    response => response,\n    error => {\n        if (error.response && error.response.status === 401) {\n            // Token\u8fc7\u671f\u6216\u65e0\u6548\uff0c\u6e05\u9664\u672c\u5730\u5b58\u50a8\n            localStorage.removeItem('authToken')\n            localStorage.removeItem('user')\n            // \u53ef\u4ee5\u9009\u62e9\u91cd\u5b9a\u5411\u5230\u767b\u5f55\u9875\n            // window.location.href = '/auth'\n        }\n        return Promise.reject(error)\n    }\n)\n\n// \u8ba4\u8bc1\u76f8\u5173API\nexport async function register(username, password, email) {\n    const response = await apiClient.post('/auth/register', {\n        username,\n        password,\n        email\n    })\n    return response.data\n}\n\nexport async function login(username, password) {\n    const response = await apiClient.post('/auth/login', {\n        username,\n        password\n    })\n    \n    // \u4fdd\u5b58token\u548c\u7528\u6237\u4fe1\u606f\n    if (response.data.token) {\n        localStorage.setItem('authToken', response.data.token)\n        localStorage.setItem('user', JSON.stringify({\n            userId: response.data.userId,\n            username: response.data.username\n        }))\n    }\n    \n    return response.data\n}\n\nexport function logout() {\n    localStorage.removeItem('authToken')\n    localStorage.removeItem('user')\n}\n\nexport function getCurrentUser() {\n    const userStr = localStorage.getItem('user')\n    return userStr ? JSON.parse(userStr) : null\n}\n\nexport function isAuthenticated() {\n    return !!localStorage.getItem('authToken')\n}\n\n// \u8d2d\u7269\u8f66\u76f8\u5173API\nexport async function getCart() {\n    const response = await apiClient.get('/cart')\n    return response.data\n}\n\nexport async function postCart(obj, quantity = 1) {\n    const response = await apiClient.post('/cart', {\n        productId: obj.productId,\n        quantity: quantity\n    })\n    return response.data\n}\n\nexport async function putCart(obj, quantity) {\n    const response = await apiClient.put(`/cart/${obj.productId}`, {\n        quantity: quantity\n    })\n    return response.data\n}\n\nexport async function cartMigrate() {\n    const response = await apiClient.post('/cart/migrate')\n    return response.data\n}\n\nexport async function cartCheckout() {\n    const response = await apiClient.post('/cart/checkout')\n    return response.data\n}\n\n// \u4ea7\u54c1\u76f8\u5173API\nexport async function getProducts() {\n    const response = await apiClient.get('/product')\n    return response.data\n}\n\nexport async function getProduct(productId) {\n    const response = await apiClient.get(`/product/${productId}`)\n    return response.data\n}", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 3008, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}}}